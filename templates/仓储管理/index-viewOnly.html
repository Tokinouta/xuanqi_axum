<html>

<head>
  <meta charset="utf-8">
  <title>记忆宫殿|公开查看链接-第二大脑</title>
  <link rel="shortcut icon" href="/static/仓储管理/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=0.8, maximum-scale=0.8, user-scalable=0">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha256-93wNFzm2GO3EoByj9rKZCwGjAJAwr0nujPaOgwUt8ZQ=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-vue@2.21.2/dist/bootstrap-vue.min.css"
    integrity="sha256-cAyk5KZc7P6j7j/uL7MOoN4PRsZYp+BN9yo03Y6Qk38=" crossorigin="anonymous">
  <style>
    html,
    body {
      /* zoom: 100%; */
      max-width: 100%;
      overflow-x: hidden;
      font-size: 13px;
    }

    .NOBORDER {
      box-shadow: none;
      padding: 0px 10px 0px 0px;
    }

    .vertical_center {
      margin-top: 25px;
      transform: translateY(-50%);
    }

    /* ↑navbar需要 */
    .input_box {
      border: none;
      border-radius: 300px;
      background-color: #ffd231;
      color: #a83b00;
    }

    ::placeholder {
      font-weight: bold;
      color: #cf8212;
      opacity: 1;
    }

    .modal-dialog {
      max-width: calc(80% - 20px);
    }

    textarea {
      font-family: 'Sarasa Term SC', 'Menlo'
    }

    #searchButton:hover {
      border-radius: 25px;
      box-shadow: 1px 1px 10px rgb(228, 80, 0);
    }

    #searchButton:active {
      border-radius: 25px;
      box-shadow: 1px 1px 10px rgb(155, 0, 155);
    }

    .bg-info {
      background-color: rgb(43, 190, 254) !important;
    }

    hr {
      border-top: 3px solid rgb(80, 255, 203)
    }

    .form-control {
      border-top: 3px solid rgb(120, 235, 255)
    }

    .card-body {
      padding: 15px;
    }

    .btn-info {
      background-color: #1780b8;
      border-color: #137af7;
    }

    .btn-outline-info {
      padding: 0px 4px !important;
    }

    .bdispl {
      position: relative;
      margin: 0 0 0 26px;
      padding: 2px 12px 8px 12px;
      border: 1px solid transparent;
      border-top: 2px solid #e9f4f7;
      border-left: 6px solid #86b7c4;
      border-radius: 6px;
    }

    .bbtmbtn {
      margin: 0 0 0 26px;
    }

    .nopad {
      padding: 0;
      margin: 0 5px 5px;
    }

    .nomargin {
      margin: 0 !important;
    }

    .TheFocusedItem {
      background: linear-gradient(#e8fdff, #ffffff, #ffffff);
      border-top: 2px solid #81c9f8;
      border-left: 6px solid #81c9f8;
    }

    .TheFocusedItem:active {
      border-top: 2px solid #3888f1;
      border-left: 6px solid #3888f1;
    }

    name {
      font: bold 22px/1.5 "Georgia", sans-serif;
      margin-right: 20px;
    }

    datemark {
      font: bold 22px/1.5 "Sarasa Term SC", 'Menlo', sans-serif;
      color: #d99903;
      background-color: #fffa;
      position: relative;
      z-index: 200;
    }

    descr {
      margin-top: 4px;
      color: rgb(81, 59, 45);
      font: 400 13px/1.5 "Sarasa Term SC", 'Menlo', "Georgia", sans-serif;
      white-space: pre-wrap;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      overflow: hidden;
      -webkit-line-clamp: none;
    }

    descrNote {
      margin-top: 4px;
      color: rgb(150, 188, 219);
      font: 500 12px/1.5 "Sarasa Term SC", 'Menlo', "Georgia", sans-serif;
    }

    deadLine {
      margin-top: 0px;
      color: rgb(9, 83, 145);
      font: 500 14px/1.5 "Sarasa Term SC", 'Menlo', "Georgia", sans-serif;
    }

    .linesX {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      overflow: hidden;
      -webkit-line-clamp: 4;
    }

    type {
      padding: 0px 5px;
      display: inline-block;
      font: bold 13px/1.5 "Georgia", sans-serif;
      color: rgb(0, 35, 139);
      border-radius: 5px;
    }

    type:hover {
      background-color: #cbc9ff;
    }

    type:active {
      background-color: #fffbc9;
    }

    type2 {
      white-space: pre-wrap;
      padding: 0.5px 11px;
      display: inline-block;
      font: bold 11px/1.2 "Georgia", sans-serif;
      color: rgba(37, 41, 87, 0.778);
      border-radius: 5px;
    }

    type2:hover {
      background-color: #fff1c9;
    }

    .btn-info {
      padding: 2px;
    }

    #dropdown-form-sentence__BV_toggle_ {
      padding: 0;
    }

    .pathnode {
      display: inline-block;
      margin: 2px;
      padding: 2px;
      border: 2px solid rgb(255, 188, 181);
      border-radius: 5px;
      font: bold 10px/1.2 "Georgia", sans-serif;
      color: rgb(32, 50, 67);
    }

    .searchres:hover {
      background: linear-gradient(#d9f9fc, #f8fcff, #ffffff);
      border-radius: 5px;
    }

    .TXTsearchres {
      background-color: rgb(255, 239, 211);
      border-radius: 5px;
      border-top: 2px solid #ffe7bc !important;
      border-left: 6px solid #c4b586 !important;
    }

    .TXTsearchres:hover {
      background: linear-gradient(#ffd231, #fee8c2, #ffefd3);
    }

    .upperDirInfo {
      background-color: rgb(255, 248, 211);
      border-radius: 5px;
      border-top: 2px solid #ffcdbc !important;
      border-left: 6px solid #de7054 !important;
    }

    .upperDirInfo:hover {
      background: linear-gradient(#ffe431, #feefc2, #fff4d3);
    }

    #resultScrollMark {
      background-color: red;
      color: white;
      font: bold 2em "Georgia", serif;
      padding: 12px;
      border-radius: 10px;
    }

    par {
      white-space: pre-wrap;
      display: block;
      margin-top: 3px;
      border: 3px solid rgb(255, 169, 165);
      border-bottom: none;
      border-radius: 10px;
      line-height: 19pt;
      font-size: 18px;
      padding: 9px;
    }

    .focuspar {
      background-color: #ffd231;
      color: #a83b00;
    }

    .thumbimgSpan {
      display: inline-block;
      background-color: white;
      box-shadow: 0px 2px 15px -2px #cee2dc;
      border-radius: 10px;
      padding: 5px;
      margin: 5px;
    }

    .thumbimage {
      max-width: 120px;
      max-height: 120px;
      object-fit: contain;
    }

    .toast-body {
      white-space: pre-wrap;
    }

    scrollNav {
      text-align: center;
      display: block;
      position: absolute;
      color: #6fbeeb;
    }

    scrollNum {
      text-combine-upright: all;
      width: 100%;
      writing-mode: vertical-rl;
      padding: 4px 2px;
      border: 1px solid #6cccff70;
      color: #0d6597;
      font: 13px bold;
    }

    scrollToTop {
      display: block;
      width: 100%;
      height: 29px;
      font: 18px bold;
      padding-top: 5px;
      border-radius: 10px 6px 2px 2px;
      border: 1px solid #6cccff70;
      background-color: #96e4f127;
    }

    scrollToDown {
      display: block;
      width: 100%;
      height: 29px;
      font: 18px bold;
      padding-top: 5px;
      border-radius: 2px 2px 6px 10px;
      border: 1px solid #6cccff70;
      background-color: #96e4f127;
    }
  </style>
</head>

<body>
  <div id="app">
    <!-- 管理备份边栏 -->
    <b-sidebar id="sidebar-2" title="🧰备份恢复边栏" right shadow v-model="showBackupSidebar" width="460px"
      backdrop-variant="warning" z-index="1041" backdrop>
      <div class="px-3 py-2" style="white-space: pre-wrap;font-family: Georgia, serif;">
        <b-button variant="warning" @click="createNewBackup()">当前新建备份，↓输入名称</b-button>
        <b-form-input v-model="newBackupName" type="text" placeholder="输入备份名称~"></b-form-input>
        <div v-for="backup in backupList">
          <par>{{backup}}<br>
            <b-button variant="warning" @click="restoreBackup(backup)">恢复这个备份</b-button>
            <b-button variant="warning" @click="removeBackup(backup)">删除这个备份</b-button>
          </par>
        </div>
      </div>
    </b-sidebar>
    <!-- 管理库的总边栏 -->
    <b-sidebar id="sidebar-1" title="🛍仓库管理边栏" left shadow v-model="showSidebar" width="460px"
      backdrop-variant="transparent" backdrop>
      <div class="px-3 py-2" style="white-space: pre-wrap;font-family: Georgia, serif;">
        <b-button class="mt-1" variant="warning" @click="rebuildNGT">重建ngt搜索&保存</b-button>
        <b-button class="mt-1" variant="warning" @click="prepareBackupSidebar()">管理备份</b-button><br>
        <b-button class="mt-1" variant="warning" @click="rebuildNGTReloadVec">重建ngt搜索(强行重置全部词向量数据)</b-button><br>
        <b-button class="mt-1" variant="outline-danger" @click="clearTemp()">清理当前temp上传文件夹</b-button>
        <div class="mt-1">基本搜索模式：<b-form-radio-group button-variant="outline-primary" v-model="fullTxtPressed"
            :options="[{text:'全文搜索',value:[true,true,true]},{text:'仅原文搜索，无difflib相似',value:[true,false,true]},{text:'无原文搜索',value:[false,false,true]}]"
            buttons @change="showSidebar=false"></b-form-radio-group><br>
          原文搜索开关：<b-button-group class="mt-1">
            <b-button variant="outline-primary" :pressed.sync="fullTxtPressed[0]">原文</b-button>
            <b-button variant="outline-primary" :pressed.sync="fullTxtPressed[1]">difflib</b-button>
            <b-button variant="outline-primary" :pressed.sync="fullTxtPressed[2]">ngt</b-button>
          </b-button-group>
        </div>
        <p>当前用户：<name>{{signup_username}}</name>
        </p>
        <p>当前所在仓库：{{CurWarehouse}}</p>
        <div v-for="wh, ind in warehouses">
          <par :class="{'focuspar':wh==CurWarehouse}" style="height: 64px">{{wh}}<b-button variant="warning"
              @click="warehouseFocus(ind)" style="height: 40px;float: right;">选择</b-button>
          </par>
          <b-button variant="info" class="nopad"
            @click="copyStringToClipboard(window.location.href.split('/').slice(0,4).join('/')+'/'+wh)"> ⛓🏮复制链接！🎉💌
          </b-button>
          <b-button variant="warning" class="nopad" @click="renameWarehouse(ind)" v-if="wh!='事件管理ToDo'"> 改名 </b-button>
          <b-button variant="danger" class="nopad" @click="rmWarehouse(ind)" v-if="wh!='事件管理ToDo'"> 删除 </b-button>
          <b-button variant="primary" class="nopad" @click="moveUpWarehouse(ind)"> 上浮 </b-button>
          <b-button variant="success" class="nopad" @click="moveDownWarehouse(ind)"> 下移 </b-button><br><br>
        </div>
        <b-button variant="dark" @click="addWarehouse">添加新的库</b-button>
      </div>
    </b-sidebar>
    <!-- ↓标题栏。 -->
    <div style="color: white;border-bottom: 5px solid #0097e8;position: relative;top:90px">
      <b-navbar toggleable="lg" type="light" variant="info" class="NOBORDER">
        <b-navbar-brand href="/storageManager" class="NOBORDER"><a href="/storageManager"
            class="navbar-brand NOBORDER ml-2" style="font-weight: bold; font-size: 20pt; color: white;">🏵记忆宫殿</a>
        </b-navbar-brand>
        搜索结果数:<b-form-input v-model="resnumber" type="number" placeholder="200"
          style="width: 80px;display: inline-block;"></b-form-input>&nbsp;
        console:<b-form-input id="cmdcommand" v-model="consoleCmd" style="width: 200px;display: inline-block;">
        </b-form-input>&nbsp;
        <b-button variant="warning" @click="showSidebar = !showSidebar">🛍边栏管理仓库/重建ngt/备份</b-button>&nbsp;

        <b-navbar-toggle target="nav-collapse"></b-navbar-toggle>

        <b-collapse id="nav-collapse" is-nav style="padding: 0px 10px 0px 10px;">

          <!-- Right aligned nav items -->
          <b-navbar-nav class="ml-auto">

            <b-nav-item-dropdown right>
              <!-- Using 'button-content' slot -->
              <template #button-content>
                <em>
                  <span v-if="! isLoggedIn">登录</span>
                  <span v-if="isLoggedIn">已登录 |</span>
                  <svg viewBox="785 321 40 40" width="19px" height="19px" class="align-text-bottom">
                    <g id="Canvas_1" stroke="none" stroke-opacity="1" fill="none" stroke-dasharray="none"
                      fill-opacity="1">
                      <title>Canvas 1</title>
                      <g id="Canvas_1_Layer_1">
                        <title>Layer 1</title>
                        <g id="Graphic_2">
                          <title>Account Circle</title>
                          <path
                            d="M 805 321 C 793.96 321 785 329.96 785 341 C 785 352.04 793.96 361 805 361 C 816.04 361 825 352.04 825 341 C 825 329.96 816.04 321 805 321 Z M 805 327 C 808.32 327 811 329.68 811 333 C 811 336.32 808.32 339 805 339 C 801.68 339 799 336.32 799 333 C 799 329.68 801.68 327 805 327 Z M 805 355.4 C 800 355.4 795.58 352.84 793 348.96 C 793.06 344.98 801 342.8 805 342.8 C 808.98 342.8 816.94 344.98 817 348.96 C 814.42 352.84 810 355.4 805 355.4 Z"
                            fill="#146" />
                        </g>
                      </g>
                    </g>
                  </svg>
                </em>
              </template>
              <b-dropdown-item v-if="isLoggedIn" @click="logout">退出登录</b-dropdown-item>
              <b-dropdown-item v-if="! isLoggedIn" @click="$bvModal.show('bv-modal-login')">登录</b-dropdown-item>
              <b-dropdown-item>本月使用数量：{{monthlyusage}}</b-dropdown-item>
              <b-dropdown-item>文件空间使用量：{{spaceusage}}</b-dropdown-item>
              <b-dropdown-item>系统剩余空间：{{spaceleft}}</b-dropdown-item>
            </b-nav-item-dropdown>
          </b-navbar-nav>
        </b-collapse>
      </b-navbar>
    </div>


    <div class="row" style="width:70%; position: fixed;top:0;z-index: 133;">
      <div class="col-md-12 col-xl-10">
        <!-- 搜索框 -->
        <b-overlay :show="isQueryingBackend">
          <div style="padding: 10px; background-color: #f6d53029;border-radius: 14px;">
            <!-- ↓输入公式helper。 -->
            <span>
              <b-dropdown id="dropdown-dropup" text="公式" variant="warning" class="m-2"
                style="transform: translateY(-19.2px);z-index:1039;">
                <b-dropdown-item v-b-modal.modal-notes>【查看使用说明】</b-dropdown-item>
                <b-dropdown-divider></b-dropdown-divider>
                <b-dropdown-item @click="simpleExample">▶简单的计算公式模板</b-dropdown-item>
              </b-dropdown>
            </span>
            <span class="input_box" style="display: inline-block;height: 50px;width: calc(100% - 110px);">
              <span>
                <input autofocus onfocus="app.entershoulddefault = false" onblur="app.entershoulddefault = true"
                  id="mainsearchbox" v-model="query_txt" placeholder="在此输入要查询的物品(或点击公式，输入复杂查询条件)"
                  class="input_box vertical_center"
                  style="width: calc(100% - 84px);margin-left: 9px;line-height: 33px;">
                </b-form-input>
              </span>
              <span>
                <img id="searchButton" src="/static/仓储管理/searchbutton.svg" v-on:click="searchSubtree([])"
                  style="height: 41px; float: right;margin-right: 4px;" class="vertical_center">
              </span>
            </span>
          </div>
        </b-overlay>
      </div>
    </div>
    <div style="display: inline-block;height: 80px;"></div>
    <!-- ↓1.焦点行 -->
    <b-row>
      <div style="margin: 24px 30px; font-weight: 700;">
        <span style="font-size: 25px;font-family: serif;">
          <span
            style="background-image: linear-gradient(to right, #1261B2, #1276B2, #12c2c3, #12c2c3, #12c2c3);border-radius: 14px;padding: 6px;color: white;">{{CurWarehouse}}</span>
          🗃项目名单
          <b-button pill variant="warning" @click="show_search_result_mode = false">🖥浏览模式</b-button>
          <b-button pill variant="warning" @click="show_search_result_mode = true">🔍搜索模式</b-button>
          <span v-if="show_search_result_mode">（当前处于搜索模式）<br><em style="font-size: 16px;color: #1780b8;">
              搜索结果可能重复，这是由于存在词向量多对一搜索。</em>
            <b-button pill variant="outline-info" @click="show_search_result_mode = 2">只显示原文搜索</b-button>
            <b-button pill variant="outline-info" @click="show_search_result_mode = 3">只显示词向量搜索</b-button>
          </span><span v-if="! show_search_result_mode">（当前处于浏览模式）</span><br><span
            style="font-family: 'Sarasa Term SC';">
            <b-button v-if="isTimeManagement" variant="warning" @click="additems([])"> ⏰添加新事件 </b-button>
            <b-dropdown v-if="isTimeManagement && finishedTimeAsc" text="📅日历View" variant="warning">
              <b-dropdown-form>
                <b-calendar locale="zh" selected-variant="danger" nav-button-variant="warning" :date-info-fn="dateClass"
                  start-weekday="1"></b-calendar>
                <div class="mt-2">
                  <center style="font-weight: 500;">当天事件：
                    <span class="table-success" style="display: inline-block;padding: 0px 4px;border-radius: 4px;"> 1
                    </span>
                    <span class="table-primary" style="display: inline-block;padding: 0px 4px;border-radius: 4px;"> 2
                    </span>
                    <span class="table-warning" style="display: inline-block;padding: 0px 4px;border-radius: 4px;"> 3
                    </span>
                    <span class="table-danger"
                      style="display: inline-block;padding: 0px 4px;border-radius: 4px;">4+</span>
                  </center>
                </div>
            </b-dropdown>
            <datemark v-if="isTimeManagement">今天是 {{GetTodayStr().split(' ').slice(0,-1).join(' ')}}<span
                style="font-size: 15px;" class="ml-2">{{GetTodayStr().split(' ').pop()}}</span></datemark>
          </span>
        </span>
      </div>
    </b-row>
    <!-- 如果不是根目录，在此展示上层信息。 -->
    <div v-if="upperDirInfo" class="upperDirInfo bdispl">
      <span style="float: right;">
        <b-button variant="info"
          @click="upperDirInfo.ind=[];app.edittgtitem=app.upperDirInfo;app.$bvModal.show('edittargetmodal');"> 📟查看
        </b-button>
      </span>
      <span v-if="upperDirInfo.type=='事件Event'">
        <span @click="edittarget(upperDirInfo.ind)">
          <b-form-checkbox size="lg" v-model="upperDirInfo.已完成" disabled name="checkbox-1" value="已完成"
            unchecked-value="未完成" style="display: inline;"></b-form-checkbox>
        </span>
        <deadLine>🔆{{upperDirInfo.截止日期阳历}} {{weekDayMap[new Date(upperDirInfo.截止日期阳历).getDay()]}} {{upperDirInfo.截止时间}}
        </deadLine><br>
      </span>
      <name>🌴根节点信息：</name>
      <name>{{upperDirInfo.名称}}</name>类型：<type>{{upperDirInfo.type}}</type>----储存位置：<type>{{baseInd}}</type><br>
      <span v-if="upperDirInfo.rtf!=undefined">
        <b-button variant="warning" style="font-weight: bold;"
          @click="upperDirInfo.ind=[];app.edittgtitem=app.upperDirInfo;app.$bvModal.show('edittargetmodal');editRTF()">
          🍧编辑本条的RTF富格式文档 </b-button>
      </span>
      <span v-if="upperDirInfo.program!=undefined">
        <b-button variant="danger" style="font-weight: bold;"
          @click="upperDirInfo.ind=[];app.edittgtitem=app.upperDirInfo;app.$bvModal.show('edittargetmodal');editProgram()">
          🕌编辑本条的代码片段/小程序 </b-button>
      </span>
      <descrNote style="float: right">创建时间：{{upperDirInfo.setup}}<br>最近更改：{{upperDirInfo.modify}}</descrNote>
      <descr @dblclick="Vue.set(upperDirInfo, 'expandDesc', !upperDirInfo.expandDesc)"
        v-bind:class="{'linesX':!upperDirInfo.expandDesc}">描述：<span v-html="escapeHTMLgenLink(upperDirInfo.描述)"></span>
      </descr>
      <div v-for="tmpdesc in upperDirInfo.词向量描述">词向量描述：{{tmpdesc}}</div>
      <div v-for="tmpdesc in upperDirInfo.句向量描述">句向量描述：{{tmpdesc}}</div>
      <span v-if="upperDirInfo.files && upperDirInfo.files.length != 0">
        <div v-for="fileinfo, i in upperDirInfo.files">
          <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img class="thumbimage"
              @click="previewImg(fileinfo)"
              v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
          <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} | <type2>
              <type2>{{fileinfo[2]}}</type2>
            </type2>
            <descr>&emsp;&emsp;文件描述：<span v-html="escapeHTMLgenLink(fileinfo[1])"></span></descr>
          </type>
        </div>
      </span>
    </div>


    <!-- 搜索结果展示区 -->
    <div v-if="!show_search_result_mode" style="margin: 6px;">
      <div v-if="fullitems.length>2" style="position: relative;">
        <scrollNav style="width:23px;left:3px;height:106px;" class="ItemScrollNav">
          <scrollToTop onclick="ItemScrollTop(this)">
            <b-icon-chevron-double-up v-html="chvUpSvg"></b-icon-chevron-double-up>
          </scrollToTop>
          <scrollNum>{{fullitems.length}}</scrollNum>
          <scrollToDown onclick="ItemScrollDown(this)">
            <b-icon-chevron-double-down v-html="chvDownSvg"></b-icon-chevron-double-down>
          </scrollToDown>
        </scrollNav>
      </div>
      <!-- zone! -->

      <div v-for="parentitem_1, i_1 in fullitems">
        <div class="ml-2" v-if="isTimeManagement">
          <datemark v-if="i_1==0 || pI1.截止日期阳历 != fullitems[i_1-1].截止日期阳历">{{GetDateDescription(parentitem_1).split('
            ').slice(0,-1).join(' ')}}
            <span style="font-size: 15px;" class="ml-2">{{GetDateDescription(parentitem_1).split(' ').pop()}}</span>
          </datemark>
        </div>
        <!-- 上面的日期显示，也只有isTimeManagement的第一层有，其他都没有。 -->
        <div class="bdispl parentitem_1">
          <span style="float: right">
            <span v-if="parentitem_1.isfocus" id="resultScrollMark">搜索结果标记|resultScrollMark</span>
            <b-button variant="warning" class="nopad" @click="searchSubtree(parentitem_1.ind)"> 🥊搜 </b-button>
            <b-button variant="info" @click="edittarget(parentitem_1.ind)"> 📟查看 </b-button>
            <b-button v-if="! parentitem_1.内容" variant="info" @click="getitems(parentitem_1.ind)"> 🔰展开
              {{parentitem_1.subCount}} 项</b-button>
            <b-button v-if="parentitem_1.内容" variant="success" style="padding:2px;"
              @click="delete parentitem_1.内容;$forceUpdate()"> 💠收起 {{parentitem_1.subCount}} 项</b-button>
            <br>
            <descrNote style="float: right">创建时间：{{parentitem_1.setup}}<br>最近更改：{{parentitem_1.modify}}</descrNote>
          </span>
          <span v-if="parentitem_1.type=='事件Event'">
            <span @click="timeMgmtClick(parentitem_1.ind)"
              style="border-color: #ff0064;background-color: #ff0099; display: inline-block; width: 16px; height: 16px; border-radius: 4px;text-align: center;vertical-align: 6px;"><span
                style="background-color: #ffffff; display: inline-block; width: 8px; height: 2px;vertical-align: middle;margin-top: 7px;"></span></span>
            <span @click="edittarget(parentitem_1.ind)">
              <b-form-checkbox size="lg" v-model="parentitem_1.已完成" disabled name="checkbox-1" value="已完成"
                unchecked-value="未完成" style="display: inline;"></b-form-checkbox>
            </span>
            <deadLine>🔆{{parentitem_1.截止日期阳历}} {{weekDayMap[new Date(parentitem_1.截止日期阳历).getDay()]}}
              {{parentitem_1.截止时间}}</deadLine><br>
          </span>
          <name>{{parentitem_1.名称}}</name>类型：<type>{{parentitem_1.type}}</type>
          <br><span v-if="parentitem_1.rtf!=undefined">
            <b-button variant="warning" style="font-weight: bold;" @click="edittarget(parentitem_1.ind);editRTF()">
              🍧编辑本条的RTF富格式文档 </b-button>
          </span>
          <span v-if="parentitem_1.program!=undefined">
            <b-button variant="danger" style="font-weight: bold;" @click="edittarget(parentitem_1.ind);editProgram()">
              🕌编辑本条的代码片段/小程序 </b-button>
          </span>
          <span v-if="parentitem_1.files && parentitem_1.files.length != 0"><br>
            <div v-for="fileinfo, i in parentitem_1.files">
              <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img class="thumbimage"
                  @click="previewImg(fileinfo)"
                  v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
              <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} | <type2>{{fileinfo[2]}}</type2>
                <descr>&emsp;&emsp;文件描述：<span v-html="escapeHTMLgenLink(fileinfo[1])"></span></descr>
              </type>
            </div>
          </span>
          <descr @dblclick="Vue.set(parentitem_1, 'expandDesc', !parentitem_1.expandDesc)"
            v-bind:class="{'linesX':!parentitem_1.expandDesc}">描述：<span
              v-html="escapeHTMLgenLink(parentitem_1.描述)"></span></descr>
          <div v-if="parentitem_1.内容" style="margin-top:8px">
            <div v-if="parentitem_1.subCount>2" style="position: relative;">
              <scrollNav style="width:23px;left:3px;height:106px;" class="ItemScrollNav">
                <scrollToTop onclick="ItemScrollTop(this)">
                  <b-icon-chevron-double-up v-html="chvUpSvg"></b-icon-chevron-double-up>
                </scrollToTop>
                <scrollNum>{{parentitem_1.subCount}}</scrollNum>
                <scrollToDown onclick="ItemScrollDown(this)">
                  <b-icon-chevron-double-down v-html="chvDownSvg"></b-icon-chevron-double-down>
                </scrollToDown>
              </scrollNav>
            </div>

            <!-- level separator -->
            <div class="bdispl parentitem_2" v-for="parentitem_2 in parentitem_1.内容">
              <span style="float: right;">
                <span v-if="parentitem_2.isfocus" id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                <b-button variant="warning" class="nopad" @click="searchSubtree(parentitem_2.ind)"> 🥊搜 </b-button>
                <b-button variant="info" @click="edittarget(parentitem_2.ind)"> 📟查看 </b-button>
                <b-button v-if="! parentitem_2.内容" variant="info" @click="getitems(parentitem_2.ind)"> 🔰展开
                  {{parentitem_2.subCount}} 项</b-button>
                <b-button v-if="parentitem_2.内容" variant="success" style="padding:2px;"
                  @click="delete parentitem_2.内容;$forceUpdate()"> 💠收起 {{parentitem_2.subCount}} 项</b-button>
                <br>
                <descrNote style="float: right">创建时间：{{parentitem_2.setup}}<br>最近更改：{{parentitem_2.modify}}</descrNote>
              </span>
              <name>{{parentitem_2.名称}}</name>类型：<type>{{parentitem_2.type}}</type>
              <br><span v-if="parentitem_2.rtf!=undefined">
                <b-button variant="warning" style="font-weight: bold;" @click="edittarget(parentitem_2.ind);editRTF()">
                  🍧编辑本条的RTF富格式文档 </b-button>
              </span>
              <span v-if="parentitem_2.program!=undefined">
                <b-button variant="danger" style="font-weight: bold;"
                  @click="edittarget(parentitem_2.ind);editProgram()"> 🕌编辑本条的代码片段/小程序 </b-button>
              </span>
              <span v-if="parentitem_2.files && parentitem_2.files.length != 0"><br>
                <div v-for="fileinfo, i in parentitem_2.files">
                  <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img class="thumbimage"
                      @click="previewImg(fileinfo)"
                      v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                  <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} | <type2>{{fileinfo[2]}}</type2>
                    <descr>&emsp;&emsp;文件描述：<span v-html="escapeHTMLgenLink(fileinfo[1])"></span></descr>
                  </type>
                </div>
              </span>
              <descr @dblclick="parentitem_2.expandDesc=(!parentitem_2.expandDesc);app.$forceUpdate()"
                v-bind:class="{'linesX':!parentitem_2.expandDesc}">描述：<span
                  v-html="escapeHTMLgenLink(parentitem_2.描述)"></span></descr>
              <div v-if="parentitem_2.内容" style="margin-top:8px">
                <div v-if="parentitem_2.subCount>2" style="position: relative;">
                  <scrollNav style="width:23px;left:3px;height:106px;" class="ItemScrollNav">
                    <scrollToTop onclick="ItemScrollTop(this)">
                      <b-icon-chevron-double-up v-html="chvUpSvg"></b-icon-chevron-double-up>
                    </scrollToTop>
                    <scrollNum>{{parentitem_2.subCount}}</scrollNum>
                    <scrollToDown onclick="ItemScrollDown(this)">
                      <b-icon-chevron-double-down v-html="chvDownSvg"></b-icon-chevron-double-down>
                    </scrollToDown>
                  </scrollNav>
                </div>

                <!-- level separator -->
                <div class="bdispl parentitem_3" v-for="parentitem_3 in parentitem_2.内容">
                  <span style="float: right;">
                    <span v-if="parentitem_3.isfocus" id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                    <b-button variant="warning" class="nopad" @click="searchSubtree(parentitem_3.ind)"> 🥊搜 </b-button>
                    <b-button variant="info" @click="edittarget(parentitem_3.ind)"> 📟查看 </b-button>
                    <b-button v-if="! parentitem_3.内容" variant="info" @click="getitems(parentitem_3.ind)"> 🔰展开
                      {{parentitem_3.subCount}} 项</b-button>
                    <b-button v-if="parentitem_3.内容" variant="success" style="padding:2px;"
                      @click="delete parentitem_3.内容;$forceUpdate()"> 💠收起 {{parentitem_3.subCount}} 项</b-button>
                    <br>
                    <descrNote style="float: right">创建时间：{{parentitem_3.setup}}<br>最近更改：{{parentitem_3.modify}}
                    </descrNote>
                  </span>
                  <name>{{parentitem_3.名称}}</name>类型：<type>{{parentitem_3.type}}</type>
                  <br><span v-if="parentitem_3.rtf!=undefined">
                    <b-button variant="warning" style="font-weight: bold;"
                      @click="edittarget(parentitem_3.ind);editRTF()"> 🍧编辑本条的RTF富格式文档 </b-button>
                  </span>
                  <span v-if="parentitem_3.program!=undefined">
                    <b-button variant="danger" style="font-weight: bold;"
                      @click="edittarget(parentitem_3.ind);editProgram()"> 🕌编辑本条的代码片段/小程序 </b-button>
                  </span>
                  <span v-if="parentitem_3.files && parentitem_3.files.length != 0"><br>
                    <div v-for="fileinfo, i in parentitem_3.files">
                      <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img class="thumbimage"
                          @click="previewImg(fileinfo)"
                          v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                      <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} | <type2>{{fileinfo[2]}}</type2>
                        <descr>&emsp;&emsp;文件描述：<span v-html="escapeHTMLgenLink(fileinfo[1])"></span></descr>
                      </type>
                    </div>
                  </span>
                  <descr @dblclick="parentitem_3.expandDesc=(!parentitem_3.expandDesc);app.$forceUpdate()"
                    v-bind:class="{'linesX':!parentitem_3.expandDesc}">描述：<span
                      v-html="escapeHTMLgenLink(parentitem_3.描述)"></span></descr>
                  <div v-if="parentitem_3.内容" style="margin-top:8px">
                    <div v-if="parentitem_3.subCount>2" style="position: relative;">
                      <scrollNav style="width:23px;left:3px;height:106px;" class="ItemScrollNav">
                        <scrollToTop onclick="ItemScrollTop(this)">
                          <b-icon-chevron-double-up v-html="chvUpSvg"></b-icon-chevron-double-up>
                        </scrollToTop>
                        <scrollNum>{{parentitem_3.subCount}}</scrollNum>
                        <scrollToDown onclick="ItemScrollDown(this)">
                          <b-icon-chevron-double-down v-html="chvDownSvg"></b-icon-chevron-double-down>
                        </scrollToDown>
                      </scrollNav>
                    </div>

                    <!-- level separator -->
                    <div class="bdispl parentitem_4" v-for="parentitem_4 in parentitem_3.内容">
                      <span style="float: right;">
                        <span v-if="parentitem_4.isfocus" id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                        <b-button variant="warning" class="nopad" @click="searchSubtree(parentitem_4.ind)"> 🥊搜
                        </b-button>
                        <b-button variant="info" @click="edittarget(parentitem_4.ind)"> 📟查看 </b-button>
                        <b-button v-if="! parentitem_4.内容" variant="info" @click="getitems(parentitem_4.ind)"> 🔰展开
                          {{parentitem_4.subCount}} 项</b-button>
                        <b-button v-if="parentitem_4.内容" variant="success" style="padding:2px;"
                          @click="delete parentitem_4.内容;$forceUpdate()"> 💠收起 {{parentitem_4.subCount}} 项</b-button>
                        <br>
                        <descrNote style="float: right">创建时间：{{parentitem_4.setup}}<br>最近更改：{{parentitem_4.modify}}
                        </descrNote>
                      </span>
                      <name>{{parentitem_4.名称}}</name>类型：<type>{{parentitem_4.type}}</type>
                      <br><span v-if="parentitem_4.rtf!=undefined">
                        <b-button variant="warning" style="font-weight: bold;"
                          @click="edittarget(parentitem_4.ind);editRTF()"> 🍧编辑本条的RTF富格式文档 </b-button>
                      </span>
                      <span v-if="parentitem_4.program!=undefined">
                        <b-button variant="danger" style="font-weight: bold;"
                          @click="edittarget(parentitem_4.ind);editProgram()"> 🕌编辑本条的代码片段/小程序 </b-button>
                      </span>
                      <span v-if="parentitem_4.files && parentitem_4.files.length != 0"><br>
                        <div v-for="fileinfo, i in parentitem_4.files">
                          <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img class="thumbimage"
                              @click="previewImg(fileinfo)"
                              v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                          <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} | <type2>{{fileinfo[2]}}</type2>
                            <descr>&emsp;&emsp;文件描述：<span v-html="escapeHTMLgenLink(fileinfo[1])"></span></descr>
                          </type>
                        </div>
                      </span>
                      <descr @dblclick="parentitem_4.expandDesc=(!parentitem_4.expandDesc);app.$forceUpdate()"
                        v-bind:class="{'linesX':!parentitem_4.expandDesc}">描述：<span
                          v-html="escapeHTMLgenLink(parentitem_4.描述)"></span></descr>
                      <div v-if="parentitem_4.内容" style="margin-top:8px">
                        <div v-if="parentitem_4.subCount>2" style="position: relative;">
                          <scrollNav style="width:23px;left:3px;height:106px;" class="ItemScrollNav">
                            <scrollToTop onclick="ItemScrollTop(this)">
                              <b-icon-chevron-double-up v-html="chvUpSvg"></b-icon-chevron-double-up>
                            </scrollToTop>
                            <scrollNum>{{parentitem_4.subCount}}</scrollNum>
                            <scrollToDown onclick="ItemScrollDown(this)">
                              <b-icon-chevron-double-down v-html="chvDownSvg"></b-icon-chevron-double-down>
                            </scrollToDown>
                          </scrollNav>
                        </div>

                        <!-- level separator -->
                        <div class="bdispl parentitem_5" v-for="parentitem_5 in parentitem_4.内容">
                          <span style="float: right;">
                            <span v-if="parentitem_5.isfocus" id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                            <b-button variant="warning" class="nopad" @click="searchSubtree(parentitem_5.ind)"> 🥊搜
                            </b-button>
                            <b-button variant="info" @click="edittarget(parentitem_5.ind)"> 📟查看 </b-button>
                            <b-button v-if="! parentitem_5.内容" variant="info" @click="getitems(parentitem_5.ind)"> 🔰展开
                              {{parentitem_5.subCount}} 项</b-button>
                            <b-button v-if="parentitem_5.内容" variant="success" style="padding:2px;"
                              @click="delete parentitem_5.内容;$forceUpdate()"> 💠收起 {{parentitem_5.subCount}} 项
                            </b-button>
                            <br>
                            <descrNote style="float: right">创建时间：{{parentitem_5.setup}}<br>最近更改：{{parentitem_5.modify}}
                            </descrNote>
                          </span>
                          <name>{{parentitem_5.名称}}</name>类型：<type>{{parentitem_5.type}}</type>
                          <br><span v-if="parentitem_5.rtf!=undefined">
                            <b-button variant="warning" style="font-weight: bold;"
                              @click="edittarget(parentitem_5.ind);editRTF()"> 🍧编辑本条的RTF富格式文档 </b-button>
                          </span>
                          <span v-if="parentitem_5.program!=undefined">
                            <b-button variant="danger" style="font-weight: bold;"
                              @click="edittarget(parentitem_5.ind);editProgram()"> 🕌编辑本条的代码片段/小程序 </b-button>
                          </span>
                          <span v-if="parentitem_5.files && parentitem_5.files.length != 0"><br>
                            <div v-for="fileinfo, i in parentitem_5.files">
                              <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img class="thumbimage"
                                  @click="previewImg(fileinfo)"
                                  v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                              <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} | <type2>{{fileinfo[2]}}
                                </type2>
                                <descr>&emsp;&emsp;文件描述：<span v-html="escapeHTMLgenLink(fileinfo[1])"></span></descr>
                              </type>
                            </div>
                          </span>
                          <descr @dblclick="parentitem_5.expandDesc=(!parentitem_5.expandDesc);app.$forceUpdate()"
                            v-bind:class="{'linesX':!parentitem_5.expandDesc}">描述：<span
                              v-html="escapeHTMLgenLink(parentitem_5.描述)"></span></descr>
                          <div v-if="parentitem_5.内容" style="margin-top:8px">
                            <div v-if="parentitem_5.subCount>2" style="position: relative;">
                              <scrollNav style="width:23px;left:3px;height:106px;" class="ItemScrollNav">
                                <scrollToTop onclick="ItemScrollTop(this)">
                                  <b-icon-chevron-double-up v-html="chvUpSvg"></b-icon-chevron-double-up>
                                </scrollToTop>
                                <scrollNum>{{parentitem_5.subCount}}</scrollNum>
                                <scrollToDown onclick="ItemScrollDown(this)">
                                  <b-icon-chevron-double-down v-html="chvDownSvg"></b-icon-chevron-double-down>
                                </scrollToDown>
                              </scrollNav>
                            </div>

                            <!-- level separator -->
                            <div class="bdispl parentitem_6" v-for="parentitem_6 in parentitem_5.内容">
                              <span style="float: right;">
                                <span v-if="parentitem_6.isfocus" id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                                <b-button variant="warning" class="nopad" @click="searchSubtree(parentitem_6.ind)"> 🥊搜
                                </b-button>
                                <b-button variant="info" @click="edittarget(parentitem_6.ind)"> 📟查看 </b-button>
                                <b-button v-if="! parentitem_6.内容" variant="info" @click="getitems(parentitem_6.ind)">
                                  🔰展开 {{parentitem_6.subCount}} 项</b-button>
                                <b-button v-if="parentitem_6.内容" variant="success" style="padding:2px;"
                                  @click="delete parentitem_6.内容;$forceUpdate()"> 💠收起 {{parentitem_6.subCount}} 项
                                </b-button>
                                <br>
                                <descrNote style="float: right">
                                  创建时间：{{parentitem_6.setup}}<br>最近更改：{{parentitem_6.modify}}</descrNote>
                              </span>
                              <name>{{parentitem_6.名称}}</name>类型：<type>{{parentitem_6.type}}</type>
                              <br><span v-if="parentitem_6.rtf!=undefined">
                                <b-button variant="warning" style="font-weight: bold;"
                                  @click="edittarget(parentitem_6.ind);editRTF()"> 🍧编辑本条的RTF富格式文档 </b-button>
                              </span>
                              <span v-if="parentitem_6.program!=undefined">
                                <b-button variant="danger" style="font-weight: bold;"
                                  @click="edittarget(parentitem_6.ind);editProgram()"> 🕌编辑本条的代码片段/小程序 </b-button>
                              </span>
                              <span v-if="parentitem_6.files && parentitem_6.files.length != 0"><br>
                                <div v-for="fileinfo, i in parentitem_6.files">
                                  <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img class="thumbimage"
                                      @click="previewImg(fileinfo)"
                                      v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                                  <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} | <type2>{{fileinfo[2]}}
                                    </type2>
                                    <descr>&emsp;&emsp;文件描述：<span v-html="escapeHTMLgenLink(fileinfo[1])"></span>
                                    </descr>
                                  </type>
                                </div>
                              </span>
                              <descr @dblclick="parentitem_6.expandDesc=(!parentitem_6.expandDesc);app.$forceUpdate()"
                                v-bind:class="{'linesX':!parentitem_6.expandDesc}">描述：<span
                                  v-html="escapeHTMLgenLink(parentitem_6.描述)"></span></descr>
                              <div v-if="parentitem_6.内容" style="margin-top:8px">
                                <div v-if="parentitem_6.subCount>2" style="position: relative;">
                                  <scrollNav style="width:23px;left:3px;height:106px;" class="ItemScrollNav">
                                    <scrollToTop onclick="ItemScrollTop(this)">
                                      <b-icon-chevron-double-up v-html="chvUpSvg"></b-icon-chevron-double-up>
                                    </scrollToTop>
                                    <scrollNum>{{parentitem_6.subCount}}</scrollNum>
                                    <scrollToDown onclick="ItemScrollDown(this)">
                                      <b-icon-chevron-double-down v-html="chvDownSvg"></b-icon-chevron-double-down>
                                    </scrollToDown>
                                  </scrollNav>
                                </div>

                                <!-- level separator -->
                                <div class="bdispl parentitem_7" v-for="parentitem_7 in parentitem_6.内容">
                                  <span style="float: right;">
                                    <span v-if="parentitem_7.isfocus"
                                      id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                                    <b-button variant="warning" class="nopad" @click="searchSubtree(parentitem_7.ind)">
                                      🥊搜 </b-button>
                                    <b-button variant="info" @click="edittarget(parentitem_7.ind)"> 📟查看 </b-button>
                                    <b-button v-if="! parentitem_7.内容" variant="info"
                                      @click="getitems(parentitem_7.ind)"> 🔰展开 {{parentitem_7.subCount}} 项</b-button>
                                    <b-button v-if="parentitem_7.内容" variant="success" style="padding:2px;"
                                      @click="delete parentitem_7.内容;$forceUpdate()"> 💠收起 {{parentitem_7.subCount}} 项
                                    </b-button>
                                    <br>
                                    <descrNote style="float: right">
                                      创建时间：{{parentitem_7.setup}}<br>最近更改：{{parentitem_7.modify}}</descrNote>
                                  </span>
                                  <name>{{parentitem_7.名称}}</name>类型：<type>{{parentitem_7.type}}</type>
                                  <br><span v-if="parentitem_7.rtf!=undefined">
                                    <b-button variant="warning" style="font-weight: bold;"
                                      @click="edittarget(parentitem_7.ind);editRTF()"> 🍧编辑本条的RTF富格式文档 </b-button>
                                  </span>
                                  <span v-if="parentitem_7.program!=undefined">
                                    <b-button variant="danger" style="font-weight: bold;"
                                      @click="edittarget(parentitem_7.ind);editProgram()"> 🕌编辑本条的代码片段/小程序 </b-button>
                                  </span>
                                  <span v-if="parentitem_7.files && parentitem_7.files.length != 0"><br>
                                    <div v-for="fileinfo, i in parentitem_7.files">
                                      <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img class="thumbimage"
                                          @click="previewImg(fileinfo)"
                                          v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                                      <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} | <type2>
                                          {{fileinfo[2]}}</type2>
                                        <descr>&emsp;&emsp;文件描述：<span v-html="escapeHTMLgenLink(fileinfo[1])"></span>
                                        </descr>
                                      </type>
                                    </div>
                                  </span>
                                  <descr
                                    @dblclick="parentitem_7.expandDesc=(!parentitem_7.expandDesc);app.$forceUpdate()"
                                    v-bind:class="{'linesX':!parentitem_7.expandDesc}">描述：<span
                                      v-html="escapeHTMLgenLink(parentitem_7.描述)"></span></descr>
                                  <div v-if="parentitem_7.内容" style="margin-top:8px">
                                    <div v-if="parentitem_7.subCount>2" style="position: relative;">
                                      <scrollNav style="width:23px;left:3px;height:106px;" class="ItemScrollNav">
                                        <scrollToTop onclick="ItemScrollTop(this)">
                                          <b-icon-chevron-double-up v-html="chvUpSvg"></b-icon-chevron-double-up>
                                        </scrollToTop>
                                        <scrollNum>{{parentitem_7.subCount}}</scrollNum>
                                        <scrollToDown onclick="ItemScrollDown(this)">
                                          <b-icon-chevron-double-down v-html="chvDownSvg"></b-icon-chevron-double-down>
                                        </scrollToDown>
                                      </scrollNav>
                                    </div>

                                    <!-- level separator -->
                                    <div class="bdispl parentitem_8" v-for="parentitem_8 in parentitem_7.内容">
                                      <span style="float: right;">
                                        <span v-if="parentitem_8.isfocus"
                                          id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                                        <b-button variant="warning" class="nopad"
                                          @click="searchSubtree(parentitem_8.ind)"> 🥊搜 </b-button>
                                        <b-button variant="info" @click="edittarget(parentitem_8.ind)"> 📟查看 </b-button>
                                        <b-button v-if="! parentitem_8.内容" variant="info"
                                          @click="getitems(parentitem_8.ind)"> 🔰展开 {{parentitem_8.subCount}} 项
                                        </b-button>
                                        <b-button v-if="parentitem_8.内容" variant="success" style="padding:2px;"
                                          @click="delete parentitem_8.内容;$forceUpdate()"> 💠收起 {{parentitem_8.subCount}}
                                          项</b-button>
                                        <br>
                                        <descrNote style="float: right">
                                          创建时间：{{parentitem_8.setup}}<br>最近更改：{{parentitem_8.modify}}</descrNote>
                                      </span>
                                      <name>{{parentitem_8.名称}}</name>类型：<type>{{parentitem_8.type}}</type>
                                      <br><span v-if="parentitem_8.rtf!=undefined">
                                        <b-button variant="warning" style="font-weight: bold;"
                                          @click="edittarget(parentitem_8.ind);editRTF()"> 🍧编辑本条的RTF富格式文档 </b-button>
                                      </span>
                                      <span v-if="parentitem_8.program!=undefined">
                                        <b-button variant="danger" style="font-weight: bold;"
                                          @click="edittarget(parentitem_8.ind);editProgram()"> 🕌编辑本条的代码片段/小程序
                                        </b-button>
                                      </span>
                                      <span v-if="parentitem_8.files && parentitem_8.files.length != 0"><br>
                                        <div v-for="fileinfo, i in parentitem_8.files">
                                          <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img
                                              class="thumbimage" @click="previewImg(fileinfo)"
                                              v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                                          <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} | <type2>
                                              {{fileinfo[2]}}</type2>
                                            <descr>&emsp;&emsp;文件描述：<span
                                                v-html="escapeHTMLgenLink(fileinfo[1])"></span></descr>
                                          </type>
                                        </div>
                                      </span>
                                      <descr
                                        @dblclick="parentitem_8.expandDesc=(!parentitem_8.expandDesc);app.$forceUpdate()"
                                        v-bind:class="{'linesX':!parentitem_8.expandDesc}">描述：<span
                                          v-html="escapeHTMLgenLink(parentitem_8.描述)"></span></descr>
                                      <div v-if="parentitem_8.内容" style="margin-top:8px">
                                        <div v-if="parentitem_8.subCount>2" style="position: relative;">
                                          <scrollNav style="width:23px;left:3px;height:106px;" class="ItemScrollNav">
                                            <scrollToTop onclick="ItemScrollTop(this)">
                                              <b-icon-chevron-double-up v-html="chvUpSvg"></b-icon-chevron-double-up>
                                            </scrollToTop>
                                            <scrollNum>{{parentitem_8.subCount}}</scrollNum>
                                            <scrollToDown onclick="ItemScrollDown(this)">
                                              <b-icon-chevron-double-down v-html="chvDownSvg">
                                              </b-icon-chevron-double-down>
                                            </scrollToDown>
                                          </scrollNav>
                                        </div>

                                        <!-- level separator -->
                                        <div class="bdispl parentitem_9" v-for="parentitem_9 in parentitem_8.内容">
                                          <span style="float: right;">
                                            <span v-if="parentitem_9.isfocus"
                                              id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                                            <b-button variant="warning" class="nopad"
                                              @click="searchSubtree(parentitem_9.ind)"> 🥊搜 </b-button>
                                            <b-button variant="info" @click="edittarget(parentitem_9.ind)"> 📟查看
                                            </b-button>
                                            <b-button v-if="! parentitem_9.内容" variant="info"
                                              @click="getitems(parentitem_9.ind)"> 🔰展开 {{parentitem_9.subCount}} 项
                                            </b-button>
                                            <b-button v-if="parentitem_9.内容" variant="success" style="padding:2px;"
                                              @click="delete parentitem_9.内容;$forceUpdate()"> 💠收起
                                              {{parentitem_9.subCount}} 项</b-button>
                                            <br>
                                            <descrNote style="float: right">
                                              创建时间：{{parentitem_9.setup}}<br>最近更改：{{parentitem_9.modify}}</descrNote>
                                          </span>
                                          <name>{{parentitem_9.名称}}</name>类型：<type>{{parentitem_9.type}}</type>
                                          <br><span v-if="parentitem_9.rtf!=undefined">
                                            <b-button variant="warning" style="font-weight: bold;"
                                              @click="edittarget(parentitem_9.ind);editRTF()"> 🍧编辑本条的RTF富格式文档
                                            </b-button>
                                          </span>
                                          <span v-if="parentitem_9.program!=undefined">
                                            <b-button variant="danger" style="font-weight: bold;"
                                              @click="edittarget(parentitem_9.ind);editProgram()"> 🕌编辑本条的代码片段/小程序
                                            </b-button>
                                          </span>
                                          <span v-if="parentitem_9.files && parentitem_9.files.length != 0"><br>
                                            <div v-for="fileinfo, i in parentitem_9.files">
                                              <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img
                                                  class="thumbimage" @click="previewImg(fileinfo)"
                                                  v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                                              <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} | <type2>
                                                  {{fileinfo[2]}}</type2>
                                                <descr>&emsp;&emsp;文件描述：<span
                                                    v-html="escapeHTMLgenLink(fileinfo[1])"></span></descr>
                                              </type>
                                            </div>
                                          </span>
                                          <descr
                                            @dblclick="parentitem_9.expandDesc=(!parentitem_9.expandDesc);app.$forceUpdate()"
                                            v-bind:class="{'linesX':!parentitem_9.expandDesc}">描述：<span
                                              v-html="escapeHTMLgenLink(parentitem_9.描述)"></span></descr>
                                          <div v-if="parentitem_9.内容" style="margin-top:8px">
                                            <div v-if="parentitem_9.subCount>2" style="position: relative;">
                                              <scrollNav style="width:23px;left:3px;height:106px;"
                                                class="ItemScrollNav">
                                                <scrollToTop onclick="ItemScrollTop(this)">
                                                  <b-icon-chevron-double-up v-html="chvUpSvg">
                                                  </b-icon-chevron-double-up>
                                                </scrollToTop>
                                                <scrollNum>{{parentitem_9.subCount}}</scrollNum>
                                                <scrollToDown onclick="ItemScrollDown(this)">
                                                  <b-icon-chevron-double-down v-html="chvDownSvg">
                                                  </b-icon-chevron-double-down>
                                                </scrollToDown>
                                              </scrollNav>
                                            </div>

                                            <!-- level separator -->
                                            <div class="bdispl parentitem_a" v-for="parentitem_a in parentitem_9.内容">
                                              <span style="float: right;">
                                                <span v-if="parentitem_a.isfocus"
                                                  id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                                                <b-button variant="warning" class="nopad"
                                                  @click="searchSubtree(parentitem_a.ind)"> 🥊搜 </b-button>
                                                <b-button variant="info" @click="edittarget(parentitem_a.ind)"> 📟查看
                                                </b-button>
                                                <b-button v-if="! parentitem_a.内容" variant="info"
                                                  @click="getitems(parentitem_a.ind)"> 🔰展开 {{parentitem_a.subCount}} 项
                                                </b-button>
                                                <b-button v-if="parentitem_a.内容" variant="success" style="padding:2px;"
                                                  @click="delete parentitem_a.内容;$forceUpdate()"> 💠收起
                                                  {{parentitem_a.subCount}} 项</b-button>
                                                <br>
                                                <descrNote style="float: right">
                                                  创建时间：{{parentitem_a.setup}}<br>最近更改：{{parentitem_a.modify}}
                                                </descrNote>
                                              </span>
                                              <name>{{parentitem_a.名称}}</name>类型：<type>{{parentitem_a.type}}</type>
                                              <br><span v-if="parentitem_a.rtf!=undefined">
                                                <b-button variant="warning" style="font-weight: bold;"
                                                  @click="edittarget(parentitem_a.ind);editRTF()"> 🍧编辑本条的RTF富格式文档
                                                </b-button>
                                              </span>
                                              <span v-if="parentitem_a.program!=undefined">
                                                <b-button variant="danger" style="font-weight: bold;"
                                                  @click="edittarget(parentitem_a.ind);editProgram()"> 🕌编辑本条的代码片段/小程序
                                                </b-button>
                                              </span>
                                              <span v-if="parentitem_a.files && parentitem_a.files.length != 0"><br>
                                                <div v-for="fileinfo, i in parentitem_a.files">
                                                  <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img
                                                      class="thumbimage" @click="previewImg(fileinfo)"
                                                      v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                                                  <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} |
                                                    <type2>{{fileinfo[2]}}</type2>
                                                    <descr>&emsp;&emsp;文件描述：<span
                                                        v-html="escapeHTMLgenLink(fileinfo[1])"></span></descr>
                                                  </type>
                                                </div>
                                              </span>
                                              <descr
                                                @dblclick="parentitem_a.expandDesc=(!parentitem_a.expandDesc);app.$forceUpdate()"
                                                v-bind:class="{'linesX':!parentitem_a.expandDesc}">描述：<span
                                                  v-html="escapeHTMLgenLink(parentitem_a.描述)"></span></descr>
                                              <div v-if="parentitem_a.内容" style="margin-top:8px">
                                                <div v-if="parentitem_a.subCount>2" style="position: relative;">
                                                  <scrollNav style="width:23px;left:3px;height:106px;"
                                                    class="ItemScrollNav">
                                                    <scrollToTop onclick="ItemScrollTop(this)">
                                                      <b-icon-chevron-double-up v-html="chvUpSvg">
                                                      </b-icon-chevron-double-up>
                                                    </scrollToTop>
                                                    <scrollNum>{{parentitem_a.subCount}}</scrollNum>
                                                    <scrollToDown onclick="ItemScrollDown(this)">
                                                      <b-icon-chevron-double-down v-html="chvDownSvg">
                                                      </b-icon-chevron-double-down>
                                                    </scrollToDown>
                                                  </scrollNav>
                                                </div>

                                                <!-- level separator -->
                                                <div class="bdispl parentitem_b"
                                                  v-for="parentitem_b in parentitem_a.内容">
                                                  <span style="float: right;">
                                                    <span v-if="parentitem_b.isfocus"
                                                      id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                                                    <b-button variant="warning" class="nopad"
                                                      @click="searchSubtree(parentitem_b.ind)"> 🥊搜 </b-button>
                                                    <b-button variant="info" @click="edittarget(parentitem_b.ind)"> 📟查看
                                                    </b-button>
                                                    <b-button v-if="! parentitem_b.内容" variant="info"
                                                      @click="getitems(parentitem_b.ind)"> 🔰展开
                                                      {{parentitem_b.subCount}} 项</b-button>
                                                    <b-button v-if="parentitem_b.内容" variant="success"
                                                      style="padding:2px;"
                                                      @click="delete parentitem_b.内容;$forceUpdate()"> 💠收起
                                                      {{parentitem_b.subCount}} 项</b-button>
                                                    <br>
                                                    <descrNote style="float: right">
                                                      创建时间：{{parentitem_b.setup}}<br>最近更改：{{parentitem_b.modify}}
                                                    </descrNote>
                                                  </span>
                                                  <name>{{parentitem_b.名称}}</name>类型：<type>{{parentitem_b.type}}</type>
                                                  <br><span v-if="parentitem_b.rtf!=undefined">
                                                    <b-button variant="warning" style="font-weight: bold;"
                                                      @click="edittarget(parentitem_b.ind);editRTF()"> 🍧编辑本条的RTF富格式文档
                                                    </b-button>
                                                  </span>
                                                  <span v-if="parentitem_b.program!=undefined">
                                                    <b-button variant="danger" style="font-weight: bold;"
                                                      @click="edittarget(parentitem_b.ind);editProgram()">
                                                      🕌编辑本条的代码片段/小程序 </b-button>
                                                  </span>
                                                  <span v-if="parentitem_b.files && parentitem_b.files.length != 0"><br>
                                                    <div v-for="fileinfo, i in parentitem_b.files">
                                                      <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img
                                                          class="thumbimage" @click="previewImg(fileinfo)"
                                                          v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                                                      <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} |
                                                        <type2>{{fileinfo[2]}}</type2>
                                                        <descr>&emsp;&emsp;文件描述：<span
                                                            v-html="escapeHTMLgenLink(fileinfo[1])"></span></descr>
                                                      </type>
                                                    </div>
                                                  </span>
                                                  <descr
                                                    @dblclick="parentitem_b.expandDesc=(!parentitem_b.expandDesc);app.$forceUpdate()"
                                                    v-bind:class="{'linesX':!parentitem_b.expandDesc}">描述：<span
                                                      v-html="escapeHTMLgenLink(parentitem_b.描述)"></span></descr>
                                                  <div v-if="parentitem_b.内容" style="margin-top:8px">
                                                    <div v-if="parentitem_b.subCount>2" style="position: relative;">
                                                      <scrollNav style="width:23px;left:3px;height:106px;"
                                                        class="ItemScrollNav">
                                                        <scrollToTop onclick="ItemScrollTop(this)">
                                                          <b-icon-chevron-double-up v-html="chvUpSvg">
                                                          </b-icon-chevron-double-up>
                                                        </scrollToTop>
                                                        <scrollNum>{{parentitem_b.subCount}}</scrollNum>
                                                        <scrollToDown onclick="ItemScrollDown(this)">
                                                          <b-icon-chevron-double-down v-html="chvDownSvg">
                                                          </b-icon-chevron-double-down>
                                                        </scrollToDown>
                                                      </scrollNav>
                                                    </div>

                                                    <!-- level separator -->
                                                    <div class="bdispl parentitem_c"
                                                      v-for="parentitem_c in parentitem_b.内容">
                                                      <span style="float: right;">
                                                        <span v-if="parentitem_c.isfocus"
                                                          id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                                                        <b-button variant="warning" class="nopad"
                                                          @click="searchSubtree(parentitem_c.ind)"> 🥊搜 </b-button>
                                                        <b-button variant="info" @click="edittarget(parentitem_c.ind)">
                                                          📟查看 </b-button>
                                                        <b-button v-if="! parentitem_c.内容" variant="info"
                                                          @click="getitems(parentitem_c.ind)"> 🔰展开
                                                          {{parentitem_c.subCount}} 项</b-button>
                                                        <b-button v-if="parentitem_c.内容" variant="success"
                                                          style="padding:2px;"
                                                          @click="delete parentitem_c.内容;$forceUpdate()"> 💠收起
                                                          {{parentitem_c.subCount}} 项</b-button>
                                                        <br>
                                                        <descrNote style="float: right">
                                                          创建时间：{{parentitem_c.setup}}<br>最近更改：{{parentitem_c.modify}}
                                                        </descrNote>
                                                      </span>
                                                      <name>{{parentitem_c.名称}}</name>类型：<type>{{parentitem_c.type}}
                                                      </type>
                                                      <br><span v-if="parentitem_c.rtf!=undefined">
                                                        <b-button variant="warning" style="font-weight: bold;"
                                                          @click="edittarget(parentitem_c.ind);editRTF()">
                                                          🍧编辑本条的RTF富格式文档 </b-button>
                                                      </span>
                                                      <span v-if="parentitem_c.program!=undefined">
                                                        <b-button variant="danger" style="font-weight: bold;"
                                                          @click="edittarget(parentitem_c.ind);editProgram()">
                                                          🕌编辑本条的代码片段/小程序 </b-button>
                                                      </span>
                                                      <span
                                                        v-if="parentitem_c.files && parentitem_c.files.length != 0"><br>
                                                        <div v-for="fileinfo, i in parentitem_c.files">
                                                          <span class="thumbimgSpan"
                                                            v-if="fileinfo[3]=='thumbnail'"><img class="thumbimage"
                                                              @click="previewImg(fileinfo)"
                                                              v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                                                          <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}}
                                                            | <type2>{{fileinfo[2]}}</type2>
                                                            <descr>&emsp;&emsp;文件描述：<span
                                                                v-html="escapeHTMLgenLink(fileinfo[1])"></span></descr>
                                                          </type>
                                                        </div>
                                                      </span>
                                                      <descr
                                                        @dblclick="parentitem_c.expandDesc=(!parentitem_c.expandDesc);app.$forceUpdate()"
                                                        v-bind:class="{'linesX':!parentitem_c.expandDesc}">描述：<span
                                                          v-html="escapeHTMLgenLink(parentitem_c.描述)"></span></descr>
                                                      <div v-if="parentitem_c.内容" style="margin-top:8px">
                                                        <div v-if="parentitem_c.subCount>2" style="position: relative;">
                                                          <scrollNav style="width:23px;left:3px;height:106px;"
                                                            class="ItemScrollNav">
                                                            <scrollToTop onclick="ItemScrollTop(this)">
                                                              <b-icon-chevron-double-up v-html="chvUpSvg">
                                                              </b-icon-chevron-double-up>
                                                            </scrollToTop>
                                                            <scrollNum>{{parentitem_c.subCount}}</scrollNum>
                                                            <scrollToDown onclick="ItemScrollDown(this)">
                                                              <b-icon-chevron-double-down v-html="chvDownSvg">
                                                              </b-icon-chevron-double-down>
                                                            </scrollToDown>
                                                          </scrollNav>
                                                        </div>

                                                        <!-- level separator -->
                                                        <div class="bdispl parentitem_d"
                                                          v-for="parentitem_d in parentitem_c.内容">
                                                          <span style="float: right;">
                                                            <span v-if="parentitem_d.isfocus"
                                                              id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                                                            <b-button variant="warning" class="nopad"
                                                              @click="searchSubtree(parentitem_d.ind)"> 🥊搜 </b-button>
                                                            <b-button variant="info"
                                                              @click="edittarget(parentitem_d.ind)"> 📟查看 </b-button>
                                                            <b-button v-if="! parentitem_d.内容" variant="info"
                                                              @click="getitems(parentitem_d.ind)"> 🔰展开
                                                              {{parentitem_d.subCount}} 项</b-button>
                                                            <b-button v-if="parentitem_d.内容" variant="success"
                                                              style="padding:2px;"
                                                              @click="delete parentitem_d.内容;$forceUpdate()"> 💠收起
                                                              {{parentitem_d.subCount}} 项</b-button>
                                                            <br>
                                                            <descrNote style="float: right">
                                                              创建时间：{{parentitem_d.setup}}<br>最近更改：{{parentitem_d.modify}}
                                                            </descrNote>
                                                          </span>
                                                          <name>{{parentitem_d.名称}}</name>类型：<type>{{parentitem_d.type}}
                                                          </type>
                                                          <br><span v-if="parentitem_d.rtf!=undefined">
                                                            <b-button variant="warning" style="font-weight: bold;"
                                                              @click="edittarget(parentitem_d.ind);editRTF()">
                                                              🍧编辑本条的RTF富格式文档 </b-button>
                                                          </span>
                                                          <span v-if="parentitem_d.program!=undefined">
                                                            <b-button variant="danger" style="font-weight: bold;"
                                                              @click="edittarget(parentitem_d.ind);editProgram()">
                                                              🕌编辑本条的代码片段/小程序 </b-button>
                                                          </span>
                                                          <span
                                                            v-if="parentitem_d.files && parentitem_d.files.length != 0"><br>
                                                            <div v-for="fileinfo, i in parentitem_d.files">
                                                              <span class="thumbimgSpan"
                                                                v-if="fileinfo[3]=='thumbnail'"><img class="thumbimage"
                                                                  @click="previewImg(fileinfo)"
                                                                  v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                                                              <type @dblclick="getfile(fileinfo)">
                                                                📑文件{{i}}：{{fileinfo[0]}} | <type2>{{fileinfo[2]}}
                                                                </type2>
                                                                <descr>&emsp;&emsp;文件描述：<span
                                                                    v-html="escapeHTMLgenLink(fileinfo[1])"></span>
                                                                </descr>
                                                              </type>
                                                            </div>
                                                          </span>
                                                          <descr
                                                            @dblclick="parentitem_d.expandDesc=(!parentitem_d.expandDesc);app.$forceUpdate()"
                                                            v-bind:class="{'linesX':!parentitem_d.expandDesc}">描述：<span
                                                              v-html="escapeHTMLgenLink(parentitem_d.描述)"></span>
                                                          </descr>
                                                          <div v-if="parentitem_d.内容" style="margin-top:8px">
                                                            <div v-if="parentitem_d.subCount>2"
                                                              style="position: relative;">
                                                              <scrollNav style="width:23px;left:3px;height:106px;"
                                                                class="ItemScrollNav">
                                                                <scrollToTop onclick="ItemScrollTop(this)">
                                                                  <b-icon-chevron-double-up v-html="chvUpSvg">
                                                                  </b-icon-chevron-double-up>
                                                                </scrollToTop>
                                                                <scrollNum>{{parentitem_d.subCount}}</scrollNum>
                                                                <scrollToDown onclick="ItemScrollDown(this)">
                                                                  <b-icon-chevron-double-down v-html="chvDownSvg">
                                                                  </b-icon-chevron-double-down>
                                                                </scrollToDown>
                                                              </scrollNav>
                                                            </div>

                                                            <!-- level separator -->
                                                            <div class="bdispl parentitem_e"
                                                              v-for="parentitem_e in parentitem_d.内容">
                                                              <span style="float: right;">
                                                                <span v-if="parentitem_e.isfocus"
                                                                  id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                                                                <b-button variant="warning" class="nopad"
                                                                  @click="searchSubtree(parentitem_e.ind)"> 🥊搜
                                                                </b-button>
                                                                <b-button variant="info"
                                                                  @click="edittarget(parentitem_e.ind)"> 📟查看
                                                                </b-button>
                                                                <b-button v-if="! parentitem_e.内容" variant="info"
                                                                  @click="getitems(parentitem_e.ind)"> 🔰展开
                                                                  {{parentitem_e.subCount}} 项</b-button>
                                                                <b-button v-if="parentitem_e.内容" variant="success"
                                                                  style="padding:2px;"
                                                                  @click="delete parentitem_e.内容;$forceUpdate()"> 💠收起
                                                                  {{parentitem_e.subCount}} 项</b-button>
                                                                <br>
                                                                <descrNote style="float: right">
                                                                  创建时间：{{parentitem_e.setup}}<br>最近更改：{{parentitem_e.modify}}
                                                                </descrNote>
                                                              </span>
                                                              <name>{{parentitem_e.名称}}</name>类型：<type>
                                                                {{parentitem_e.type}}</type>
                                                              <br><span v-if="parentitem_e.rtf!=undefined">
                                                                <b-button variant="warning" style="font-weight: bold;"
                                                                  @click="edittarget(parentitem_e.ind);editRTF()">
                                                                  🍧编辑本条的RTF富格式文档 </b-button>
                                                              </span>
                                                              <span v-if="parentitem_e.program!=undefined">
                                                                <b-button variant="danger" style="font-weight: bold;"
                                                                  @click="edittarget(parentitem_e.ind);editProgram()">
                                                                  🕌编辑本条的代码片段/小程序 </b-button>
                                                              </span>
                                                              <span
                                                                v-if="parentitem_e.files && parentitem_e.files.length != 0"><br>
                                                                <div v-for="fileinfo, i in parentitem_e.files">
                                                                  <span class="thumbimgSpan"
                                                                    v-if="fileinfo[3]=='thumbnail'"><img
                                                                      class="thumbimage" @click="previewImg(fileinfo)"
                                                                      v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                                                                  <type @dblclick="getfile(fileinfo)">
                                                                    📑文件{{i}}：{{fileinfo[0]}} | <type2>{{fileinfo[2]}}
                                                                    </type2>
                                                                    <descr>&emsp;&emsp;文件描述：<span
                                                                        v-html="escapeHTMLgenLink(fileinfo[1])"></span>
                                                                    </descr>
                                                                  </type>
                                                                </div>
                                                              </span>
                                                              <descr
                                                                @dblclick="parentitem_e.expandDesc=(!parentitem_e.expandDesc);app.$forceUpdate()"
                                                                v-bind:class="{'linesX':!parentitem_e.expandDesc}">
                                                                描述：<span
                                                                  v-html="escapeHTMLgenLink(parentitem_e.描述)"></span>
                                                              </descr>
                                                              <div v-if="parentitem_e.内容" style="margin-top:8px">
                                                                <div v-if="parentitem_e.subCount>2"
                                                                  style="position: relative;">
                                                                  <scrollNav style="width:23px;left:3px;height:106px;"
                                                                    class="ItemScrollNav">
                                                                    <scrollToTop onclick="ItemScrollTop(this)">
                                                                      <b-icon-chevron-double-up v-html="chvUpSvg">
                                                                      </b-icon-chevron-double-up>
                                                                    </scrollToTop>
                                                                    <scrollNum>{{parentitem_e.subCount}}</scrollNum>
                                                                    <scrollToDown onclick="ItemScrollDown(this)">
                                                                      <b-icon-chevron-double-down v-html="chvDownSvg">
                                                                      </b-icon-chevron-double-down>
                                                                    </scrollToDown>
                                                                  </scrollNav>
                                                                </div>

                                                                <!-- level separator -->
                                                                <div class="bdispl parentitem_f"
                                                                  v-for="parentitem_f in parentitem_e.内容">
                                                                  <span style="float: right;">
                                                                    <span v-if="parentitem_f.isfocus"
                                                                      id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                                                                    <b-button variant="warning" class="nopad"
                                                                      @click="searchSubtree(parentitem_f.ind)"> 🥊搜
                                                                    </b-button>
                                                                    <b-button variant="info"
                                                                      @click="edittarget(parentitem_f.ind)"> 📟查看
                                                                    </b-button>
                                                                    <b-button v-if="! parentitem_f.内容" variant="info"
                                                                      @click="getitems(parentitem_f.ind)"> 🔰展开
                                                                      {{parentitem_f.subCount}} 项</b-button>
                                                                    <b-button v-if="parentitem_f.内容" variant="success"
                                                                      style="padding:2px;"
                                                                      @click="delete parentitem_f.内容;$forceUpdate()">
                                                                      💠收起 {{parentitem_f.subCount}} 项</b-button>
                                                                    <br>
                                                                    <descrNote style="float: right">
                                                                      创建时间：{{parentitem_f.setup}}<br>最近更改：{{parentitem_f.modify}}
                                                                    </descrNote>
                                                                  </span>
                                                                  <name>{{parentitem_f.名称}}</name>类型：<type>
                                                                    {{parentitem_f.type}}</type>
                                                                  <br><span v-if="parentitem_f.rtf!=undefined">
                                                                    <b-button variant="warning"
                                                                      style="font-weight: bold;"
                                                                      @click="edittarget(parentitem_f.ind);editRTF()">
                                                                      🍧编辑本条的RTF富格式文档 </b-button>
                                                                  </span>
                                                                  <span v-if="parentitem_f.program!=undefined">
                                                                    <b-button variant="danger"
                                                                      style="font-weight: bold;"
                                                                      @click="edittarget(parentitem_f.ind);editProgram()">
                                                                      🕌编辑本条的代码片段/小程序 </b-button>
                                                                  </span>
                                                                  <span
                                                                    v-if="parentitem_f.files && parentitem_f.files.length != 0"><br>
                                                                    <div v-for="fileinfo, i in parentitem_f.files">
                                                                      <span class="thumbimgSpan"
                                                                        v-if="fileinfo[3]=='thumbnail'"><img
                                                                          class="thumbimage"
                                                                          @click="previewImg(fileinfo)"
                                                                          v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                                                                      <type @dblclick="getfile(fileinfo)">
                                                                        📑文件{{i}}：{{fileinfo[0]}} | <type2>
                                                                          {{fileinfo[2]}}</type2>
                                                                        <descr>&emsp;&emsp;文件描述：<span
                                                                            v-html="escapeHTMLgenLink(fileinfo[1])"></span>
                                                                        </descr>
                                                                      </type>
                                                                    </div>
                                                                  </span>
                                                                  <descr
                                                                    @dblclick="parentitem_f.expandDesc=(!parentitem_f.expandDesc);app.$forceUpdate()"
                                                                    v-bind:class="{'linesX':!parentitem_f.expandDesc}">
                                                                    描述：<span
                                                                      v-html="escapeHTMLgenLink(parentitem_f.描述)"></span>
                                                                  </descr>
                                                                  <div v-if="parentitem_f.内容" style="margin-top:8px">
                                                                    <div v-if="parentitem_f.subCount>2"
                                                                      style="position: relative;">
                                                                      <scrollNav
                                                                        style="width:23px;left:3px;height:106px;"
                                                                        class="ItemScrollNav">
                                                                        <scrollToTop onclick="ItemScrollTop(this)">
                                                                          <b-icon-chevron-double-up v-html="chvUpSvg">
                                                                          </b-icon-chevron-double-up>
                                                                        </scrollToTop>
                                                                        <scrollNum>{{parentitem_f.subCount}}</scrollNum>
                                                                        <scrollToDown onclick="ItemScrollDown(this)">
                                                                          <b-icon-chevron-double-down
                                                                            v-html="chvDownSvg">
                                                                          </b-icon-chevron-double-down>
                                                                        </scrollToDown>
                                                                      </scrollNav>
                                                                    </div>

                                                                    <!-- level separator -->
                                                                    <div class="bdispl parentitem_g"
                                                                      v-for="parentitem_g in parentitem_f.内容">
                                                                      <span style="float: right;">
                                                                        <span v-if="parentitem_g.isfocus"
                                                                          id="resultScrollMark">搜索结果标记|resultScrollMark</span>
                                                                        <b-button variant="warning" class="nopad"
                                                                          @click="searchSubtree(parentitem_g.ind)"> 🥊搜
                                                                        </b-button>
                                                                        <b-button variant="info"
                                                                          @click="edittarget(parentitem_g.ind)"> 📟查看
                                                                        </b-button>
                                                                        <b-button v-if="! parentitem_g.内容"
                                                                          variant="info"
                                                                          @click="getitems(parentitem_g.ind)"> 🔰展开
                                                                          {{parentitem_g.subCount}} 项</b-button>
                                                                        <b-button v-if="parentitem_g.内容"
                                                                          variant="success" style="padding:2px;"
                                                                          @click="delete parentitem_g.内容;$forceUpdate()">
                                                                          💠收起 {{parentitem_g.subCount}} 项</b-button>
                                                                        <br>
                                                                        <descrNote style="float: right">
                                                                          创建时间：{{parentitem_g.setup}}<br>最近更改：{{parentitem_g.modify}}
                                                                        </descrNote>
                                                                      </span>
                                                                      <name>{{parentitem_g.名称}}</name>类型：<type>
                                                                        {{parentitem_g.type}}</type>
                                                                      <br><span v-if="parentitem_g.rtf!=undefined">
                                                                        <b-button variant="warning"
                                                                          style="font-weight: bold;"
                                                                          @click="edittarget(parentitem_g.ind);editRTF()">
                                                                          🍧编辑本条的RTF富格式文档 </b-button>
                                                                      </span>
                                                                      <span v-if="parentitem_g.program!=undefined">
                                                                        <b-button variant="danger"
                                                                          style="font-weight: bold;"
                                                                          @click="edittarget(parentitem_g.ind);editProgram()">
                                                                          🕌编辑本条的代码片段/小程序 </b-button>
                                                                      </span>
                                                                      <span
                                                                        v-if="parentitem_g.files && parentitem_g.files.length != 0"><br>
                                                                        <div v-for="fileinfo, i in parentitem_g.files">
                                                                          <span class="thumbimgSpan"
                                                                            v-if="fileinfo[3]=='thumbnail'"><img
                                                                              class="thumbimage"
                                                                              @click="previewImg(fileinfo)"
                                                                              v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
                                                                          <type @dblclick="getfile(fileinfo)">
                                                                            📑文件{{i}}：{{fileinfo[0]}} | <type2>
                                                                              {{fileinfo[2]}}</type2>
                                                                            <descr>&emsp;&emsp;文件描述：<span
                                                                                v-html="escapeHTMLgenLink(fileinfo[1])"></span>
                                                                            </descr>
                                                                          </type>
                                                                        </div>
                                                                      </span>
                                                                      <descr
                                                                        @dblclick="parentitem_g.expandDesc=(!parentitem_g.expandDesc);app.$forceUpdate()"
                                                                        v-bind:class="{'linesX':!parentitem_g.expandDesc}">
                                                                        描述：<span
                                                                          v-html="escapeHTMLgenLink(parentitem_g.描述)"></span>
                                                                      </descr>
                                                                      <div v-if="parentitem_g.内容"
                                                                        style="margin-top:8px">
                                                                        <div v-if="parentitem_g.subCount>2"
                                                                          style="position: relative;">
                                                                          <scrollNav
                                                                            style="width:23px;left:3px;height:106px;"
                                                                            class="ItemScrollNav">
                                                                            <scrollToTop onclick="ItemScrollTop(this)">
                                                                              <b-icon-chevron-double-up
                                                                                v-html="chvUpSvg">
                                                                              </b-icon-chevron-double-up>
                                                                            </scrollToTop>
                                                                            <scrollNum>{{parentitem_g.subCount}}
                                                                            </scrollNum>
                                                                            <scrollToDown
                                                                              onclick="ItemScrollDown(this)">
                                                                              <b-icon-chevron-double-down
                                                                                v-html="chvDownSvg">
                                                                              </b-icon-chevron-double-down>
                                                                            </scrollToDown>
                                                                          </scrollNav>
                                                                        </div>

                                                                        <!-- level separator -->
                                                                        <div class="bdispl parentitem_h"
                                                                          v-for="parentitem_h, i in parentitem_g.内容"
                                                                          @mouseenter="bdisplhover"
                                                                          @mouseleave="bdisplleave">
                                                                          <name>
                                                                            您这层级嵌套的也太深了。。目前程序尚不支持如此深的嵌套，如确有需要，请联系程序员郭紫辰~(解决方案：可以强行手动多写几层，也可改写js使文档加载后自动生成代码document.write。)
                                                                          </name>{{parentitem_h}} -|{}|- {{i}}
                                                                        </div>
                                                                        <div class="bbtmbtn"
                                                                          @dragenter="dragenterFLast($event, parentitem_g)"
                                                                          @dragleave="dragleaveFLast($event, parentitem_g)"
                                                                          @dragover.prevent>
                                                                          <b-button variant="info"
                                                                            @click="additems(parentitem_g.ind)">
                                                                            ╋在这一层添加新记录 </b-button>
                                                                        </div>
                                                                        <!-- level separator -->

                                                                      </div>
                                                                    </div>
                                                                    <div class="bbtmbtn"
                                                                      @dragenter="dragenterFLast($event, parentitem_f)"
                                                                      @dragleave="dragleaveFLast($event, parentitem_f)"
                                                                      @dragover.prevent>
                                                                      <b-button variant="info"
                                                                        @click="additems(parentitem_f.ind)"> ╋在这一层添加新记录
                                                                      </b-button>
                                                                    </div>
                                                                    <!-- level separator -->

                                                                  </div>
                                                                </div>
                                                                <div class="bbtmbtn"
                                                                  @dragenter="dragenterFLast($event, parentitem_e)"
                                                                  @dragleave="dragleaveFLast($event, parentitem_e)"
                                                                  @dragover.prevent>
                                                                  <b-button variant="info"
                                                                    @click="additems(parentitem_e.ind)"> ╋在这一层添加新记录
                                                                  </b-button>
                                                                </div>
                                                                <!-- level separator -->

                                                              </div>
                                                            </div>
                                                            <div class="bbtmbtn"
                                                              @dragenter="dragenterFLast($event, parentitem_d)"
                                                              @dragleave="dragleaveFLast($event, parentitem_d)"
                                                              @dragover.prevent>
                                                              <b-button variant="info"
                                                                @click="additems(parentitem_d.ind)"> ╋在这一层添加新记录
                                                              </b-button>
                                                            </div>
                                                            <!-- level separator -->

                                                          </div>
                                                        </div>
                                                        <div class="bbtmbtn"
                                                          @dragenter="dragenterFLast($event, parentitem_c)"
                                                          @dragleave="dragleaveFLast($event, parentitem_c)"
                                                          @dragover.prevent>
                                                          <b-button variant="info" @click="additems(parentitem_c.ind)">
                                                            ╋在这一层添加新记录 </b-button>
                                                        </div>
                                                        <!-- level separator -->

                                                      </div>
                                                    </div>
                                                    <div class="bbtmbtn"
                                                      @dragenter="dragenterFLast($event, parentitem_b)"
                                                      @dragleave="dragleaveFLast($event, parentitem_b)"
                                                      @dragover.prevent>
                                                      <b-button variant="info" @click="additems(parentitem_b.ind)">
                                                        ╋在这一层添加新记录 </b-button>
                                                    </div>
                                                    <!-- level separator -->

                                                  </div>
                                                </div>
                                                <div class="bbtmbtn" @dragenter="dragenterFLast($event, parentitem_a)"
                                                  @dragleave="dragleaveFLast($event, parentitem_a)" @dragover.prevent>
                                                  <b-button variant="info" @click="additems(parentitem_a.ind)">
                                                    ╋在这一层添加新记录 </b-button>
                                                </div>
                                                <!-- level separator -->

                                              </div>
                                            </div>
                                            <div class="bbtmbtn" @dragenter="dragenterFLast($event, parentitem_9)"
                                              @dragleave="dragleaveFLast($event, parentitem_9)" @dragover.prevent>
                                              <b-button variant="info" @click="additems(parentitem_9.ind)"> ╋在这一层添加新记录
                                              </b-button>
                                            </div>
                                            <!-- level separator -->

                                          </div>
                                        </div>
                                        <div class="bbtmbtn" @dragenter="dragenterFLast($event, parentitem_8)"
                                          @dragleave="dragleaveFLast($event, parentitem_8)" @dragover.prevent>
                                          <b-button variant="info" @click="additems(parentitem_8.ind)"> ╋在这一层添加新记录
                                          </b-button>
                                        </div>
                                        <!-- level separator -->

                                      </div>
                                    </div>
                                    <div class="bbtmbtn" @dragenter="dragenterFLast($event, parentitem_7)"
                                      @dragleave="dragleaveFLast($event, parentitem_7)" @dragover.prevent>
                                      <b-button variant="info" @click="additems(parentitem_7.ind)"> ╋在这一层添加新记录
                                      </b-button>
                                    </div>
                                    <!-- level separator -->

                                  </div>
                                </div>
                                <div class="bbtmbtn" @dragenter="dragenterFLast($event, parentitem_6)"
                                  @dragleave="dragleaveFLast($event, parentitem_6)" @dragover.prevent>
                                  <b-button variant="info" @click="additems(parentitem_6.ind)"> ╋在这一层添加新记录 </b-button>
                                </div>
                                <!-- level separator -->

                              </div>
                            </div>
                            <div class="bbtmbtn" @dragenter="dragenterFLast($event, parentitem_5)"
                              @dragleave="dragleaveFLast($event, parentitem_5)" @dragover.prevent>
                              <b-button variant="info" @click="additems(parentitem_5.ind)"> ╋在这一层添加新记录 </b-button>
                            </div>
                            <!-- level separator -->

                          </div>
                        </div>
                        <div class="bbtmbtn" @dragenter="dragenterFLast($event, parentitem_4)"
                          @dragleave="dragleaveFLast($event, parentitem_4)" @dragover.prevent>
                          <b-button variant="info" @click="additems(parentitem_4.ind)"> ╋在这一层添加新记录 </b-button>
                        </div>
                        <!-- level separator -->

                      </div>
                    </div>
                    <div class="bbtmbtn" @dragenter="dragenterFLast($event, parentitem_3)"
                      @dragleave="dragleaveFLast($event, parentitem_3)" @dragover.prevent>
                      <b-button variant="info" @click="additems(parentitem_3.ind)"> ╋在这一层添加新记录 </b-button>
                    </div>
                    <!-- level separator -->

                  </div>
                </div>
                <div class="bbtmbtn" @dragenter="dragenterFLast($event, parentitem_2)"
                  @dragleave="dragleaveFLast($event, parentitem_2)" @dragover.prevent>
                  <b-button variant="info" @click="additems(parentitem_2.ind)"> ╋在这一层添加新记录 </b-button>
                </div>
                <!-- level separator -->

              </div>
            </div>
            <div class="bbtmbtn" @dragenter="dragenterFLast($event, parentitem_1)"
              @dragleave="dragleaveFLast($event, parentitem_1)" @dragover.prevent>
              <b-button variant="info" @click="additems(parentitem_1.ind)"> ╋在这一层添加新记录 </b-button>
            </div>
            <!-- level separator -->

          </div>
        </div>
      </div>
      <span v-if="!isTimeManagement">
        <!-- isTimeManagement的第一层不允许拖拽进入。 -->
        <div class="bbtmbtn" @dragenter="dragenterFLast($event, fullitems)"
          @dragleave="dragleaveFLast($event, fullitems)" @dragover.prevent>
          <b-button variant="info" @click="additems([])"> ╋在这一层添加新记录 </b-button>
        </div>
      </span>
      <span v-if="isTimeManagement">
        <div class="bbtmbtn">
          <b-button variant="info" @click="additems([])"> ╋在这一层添加新记录 </b-button>
        </div>
      </span>

      <!-- zone! -->
    </div>
    <div id="dragCursor" style="width: 100%;display: none;">
      <div
        style="border:1px solid black;width: 100%;height:12px;border-width: 0 3px 1.5px 3px;border-radius: 0 0 10px 10px;">
      </div>
      <div
        style="border:1px solid black;width: 100%;height:12px;border-width: 1.5px 3px 0 3px;border-radius: 10px 10px 0 0;">
      </div>
    </div>
    <div id="dragCursorMark"></div>

    <div v-if="show_search_result_mode" style="margin: 6px;">
      <div v-for="item,i in search_result">
        <div
          v-if="(i>=(SRCurrentPage-1)*SRPerPage&&i<SRCurrentPage*SRPerPage)&&(show_search_result_mode == true || ((show_search_result_mode==2 && item.txtmatch) || (show_search_result_mode==3 && item.txtmatch!=true)))"
          class="searchres bdispl" :class="{'TXTsearchres':item.txtmatch}">
          <span style="float: right;">
            <b-button variant="info" @click="recursivelyGetItems(item.item.ind)"> 🚚浏览模式找到这个item </b-button>
            <b-button variant="warning" v-if="!item.showdetail" @click="item.showdetail=true;$forceUpdate()"> 🚧查看详细信息
            </b-button>
            <b-button variant="danger" v-if="item.showdetail" @click="item.showdetail=false;$forceUpdate()"> 🚧收起详细信息
            </b-button>
          </span>
          <name>{{item.item.名称}}</name>类型：<type>{{item.item.type}}</type>----词向量序号：<type>{{item.mainkey}}</type>
          ----句向量序号：<type>{{item.句向量mainkey}}</type>----储存位置：<type>{{item.item.ind}}</type><br>
          <descrNote style="float: right">创建时间：{{item.item.setup}}<br>最近更改：{{item.item.modify}}</descrNote>
          <div v-for="mwordinfo in item.matchword">
            <type2 style="width: 160px;font-family:Cambria, Cochin, Georgia, serif;">{{mwordinfo[0]}}</type2>
            <type2>{{mwordinfo[1]}}</type2>
          </div>
          <descr v-if="!item.showdetail" @dblclick="Vue.set(item.item, 'expandDesc', !item.item.expandDesc)"
            v-bind:class="{'linesX':!item.item.expandDesc}">
            <p style="font-weight: bold;color: #0097e8;">⇑↑⇧↑⇑ &emsp; Match Word &emsp; || 描述： </p><span
              v-html="escapeHTMLgenLink(item.item.描述)"></span>
          </descr>
          <descr v-if="item.showdetail">
            <p style="font-weight: bold;color: #0097e8;">⇑↑⇧↑⇑ &emsp; Match Word &emsp; || 描述：↓</p><br><span
              v-html="escapeHTMLgenLink(item.item.描述)"></span>
          </descr>
          <span v-if="item.showdetail">
            <div v-for="tmpdesc in item.item.词向量描述">词向量描述：{{tmpdesc}}</div>
          </span>
          <span v-if="item.showdetail">
            <div v-for="tmpdesc in item.item.句向量描述">句向量描述：{{tmpdesc}}</div>
          </span>
          <br><span v-if="item.item.rtf!=undefined">
            <b-button variant="warning" style="font-weight: bold;"
              @click="setTimeout(() => {app.edittarget(item.item.ind);app.editRTF()}, 1000*recursivelyGetItems(item.item.ind)+1000);">
              🍧编辑本条的RTF富格式文档 </b-button>
          </span>
          <span v-if="item.item.program!=undefined">
            <b-button variant="danger" style="font-weight: bold;"
              @click="setTimeout(() => {app.edittarget(item.item.ind);app.editProgram()}, 1000*recursivelyGetItems(item.item.ind)+1000);">
              🕌编辑本条的代码片段/小程序 </b-button>
          </span>
          <span v-if="item.item.files && item.item.files.length != 0">
            <br>【———— ↓ 📮📂📋文件内容 ↓————】<br>
            <div v-for="fileinfo, i in item.item.files">
              <span class="thumbimgSpan" v-if="fileinfo[3]=='thumbnail'"><img class="thumbimage"
                  @click="previewImg(fileinfo)"
                  v-bind:srclazy="encodeURI('/storageManager/get-file-ViewOnly?userName='+app.userName+'&viewUrlPath='+app.viewUrlPath.replace(/&/g,'**and**')+'&baseInd='+app.baseInd+'&authentication='+app.authentication+'&dlname='+fileinfo[0]+'&path='+fileinfo[2])"></img></span>
              <type @dblclick="getfile(fileinfo)">📑文件{{i}}：{{fileinfo[0]}} | <type2>{{fileinfo[2]}}</type2>
                <descr>&emsp;&emsp;文件描述：<span v-html="escapeHTMLgenLink(fileinfo[1])"></span></descr>
              </type>
            </div>
          </span>
          位置路径<span v-for="node in item.path">➡️<span class="pathnode">
              <type>{{node.名称}}</type>, {{node.type}}, |{{node.ind}}| <span
                @click="rmResSubtree(node.ind)">❌</span><br>{{node.描述}}
            </span></span>
        </div>
      </div>
      <span v-if="search_result.length == 0">无搜索结果</span>
      <div>
        <b-pagination class="ml-4 mt-3" v-model="SRCurrentPage" :total-rows="search_result.length" :per-page="SRPerPage"
          limit="11" first-text="开头|<<" prev-text="前一页" next-text="后一页" last-text=">>|末尾"
          @input="setTimeout(()=>{window.scrollTo(0,0)},100)"></b-pagination>
        <span class="ml-4 mt-3" style="color: dimgray;">每页显示数量：<b-form-input v-model="SRPerPage" type="number"
            style="width: 80px;display: inline-block;"></b-form-input>&emsp;当前所在页数：<b-form-input v-model="SRCurrentPage"
            type="number" style="width: 80px;display: inline-block;"></b-form-input></span>
      </div>
    </div>


    <!-- ↓登录modal。 -->
    <b-modal id="bv-modal-login" hide-footer @show="entershoulddefault = true" @hide="entershoulddefault = false">
      <b-overlay :show="busy_connecting_backend" rounded="sm">
        <template #modal-title>
          <code>用户登录</code>
        </template>
        <div class="d-block text-center">
          <h3>Hello! 欢迎登录~~~</h3>
          <br>
          <b-form-input v-model="signup_username" type="username" placeholder="输入用户名~"></b-form-input><br>
          <b-form-input v-model="signup_password" type="password" placeholder="密码"></b-form-input><br>
        </div>
        <b-button class="mt-3" block @click="login">登录</b-button>
        <b-button class="mt-3" variant="danger" block @click="$bvModal.hide('bv-modal-login')">取消</b-button>
      </b-overlay>
    </b-modal>
    <!-- ↓使用方法modal。 -->
    <b-modal id="modal-notes" ok-only scrollable title="【查看使用方法】" @show="entershoulddefault = true"
      @hide="entershoulddefault = false">
      <h5>【关于展示】</h5>
      展示界面中默认描述是省略限制为4行的，但您可以双击显示全部内容。此外，还支持您上传词条物品的一条或多条缩略图，以便信息展示。(缩略图只能由其余图像文件生成)<br><br>
      <h5>【搜索规则】</h5>
      搜索时默认为全文搜索、后附公式搜索结构，如果您不输入有效的公式，那么公式搜索结果将不存在，仅返回全文搜索结果。子树搜索结果不包含子树根节点。若结果不足，子树会逐层默认扩大搜索范围200倍，但仍有可能失败，如确有需求请增大查询数量。<br>
      多条搜索，可用#号分隔搜索串【推荐，这种搜索更具有针对性】。<br><br>
      <h5>【当您发现子树搜索时结果不全，请重新构建NGT数据结构（点击按钮~）】</h5>
      重构NGT结构也可能增加搜索效率（ignorable）。<br><br>
      <h5>【公式规则】</h5>
      公式搜索时用[&#60;&#62;]包裹词语。<br>
      可输入数学计算公式+-*/()及数字。<br>
      例如，可以搜索"[&#60;消毒液&#62;]+[&#60;洗手液&#62;]"<br>
      句向量查询默认在搜索串长度超过4、且不包含[&#60;&#62;]括号时触发。若您想要触发句向量查询，可以在句子两端放入【】强制触发：例如【这句话就会被当成句向量搜索。】<br><br>
      <h5>【console及快捷键】</h5>
      console可以帮您快速定位至想去的库，例如在console中输入"家庭物品管理"，按F1键执行命令，即可导航至家庭物品管理库。<br>
      按F1键可以执行console命令，按F2键可以快速定位光标至console处。<br>
      按F3键可以将光标定位到搜索栏处。<br><br>
      <h5>【文件功能】</h5>
      双击文件进行下载。编辑界面上传。上传界面直接粘贴的话可以粘贴图片。<br>
      服务器端已设计支持多个文件储存路径，以扩大文件的储存空间。当您剩余空间小于50GB时，服务器端日志会发出警示，请届时尽快增加硬盘数量并配置。<br><br>
      <h5>【富文本RTF编辑、小程序功能】</h5>
      若想要加入 RTF 或 小程序 内容，需要首先在编辑信息栏点击添加属性。添加后即可编辑，或删除。添加后在搜索结果中也会展示对应链接。小程序有多种模式，可支持[任意代码高亮 or
      图灵完备VueApp]。对于template，可使用\{\{\}\}来escape{{"\{\{\}\}"}}<br>
      程序编辑器搭载了prolog，您可以结合prolog与知识库的自动复制子树内描述信息，来搭建强大的传统人工智能知识库。<br><br>
      <h5>【关于信息同步】</h5>
      当您退出编辑modal时，我们会将您的数据保存。所以如果您不想保存当前数据，请即刷新页面，不要退出编辑modal。<br><br>
      <h5>【复制到库or元素的链接】</h5>
      到库的链接可以从仓库管理边栏获取；到元素的链接可从编辑界面获取。编辑界面获取的元素连接有3种，一种是可以公开分享的只能查看界面，一种是比较稳定的按照标题索引；另一种是按照位置索引。标题索引可以自动定位，但不能随意更改标题。<br><br>
      <h5>【复制元素功能】</h5>
      编辑界面右上栏有三个按钮，点第一个，在要复制的元素处点复制获取链接代码；在（可跨用户）的目标位置处打开编辑界面，仍点第一个按钮，再点粘贴即可。<br><br>
      <h5>【关于备份】</h5>
      程序会对用户数据进行备份。<br>
      保存的备份包括最近的14天的备份、最近26周的备份、以及之前全部半年度的备份（technically是最近500年的每半年备份）。<br>
      恢复备份：点击边栏仓库、点击管理备份，在备份列表中选择一个进行备份恢复即可。<br>
      目前程序功能并不完备，备份会导致中途添加文件断开链接（重构reloadVec可删除全部断开的链接，且删除未链接的文件），因此请谨慎操作少备份。<br><br>
      灵魂之眼！记忆宫殿！术数玄机！念力之源！（疯~
    </b-modal>
    <!-- ↓编辑modal。 -->
    <b-modal id="edittargetmodal"
      ignore-enforce-focus-selector=".btn button .ke-input-text, .ke-textarea, .ke-code-type, select, input, textarea"
      hide-footer size='xl' @hide="saveedittgt" @show="entershoulddefault = true;" @hide="entershoulddefault = false">
      <template #modal-header>
        <span style="font-size: 16px;font-weight: bold;">查看信息<b-button variant="outline-info" @click="showTgtInfo()">
            💡属性</b-button></span>
        <span style="float: right;">
          <b-button variant="outline-info" @click="copyPasteMgmt()">🥎复制粘贴</b-button>
          <b-button variant="outline-info" @click="copyItemLink('ind')">🔗🎣</b-button>
          <b-button variant="info" @click="copyItemLink('stable')">🔗复制稳定链接</b-button>
        </span>
      </template>
      <b-overlay :show="busy_connecting_backend" rounded="sm">
        <div class="d-block">
          <h5>名称：</h5>
          <b-form-input v-model="edittgtitem.名称" type="text" placeholder="输入名称~"></b-form-input>
          <span v-if="allowTypeSelection"><br>
            <h5>类型：</h5>
            <b-form-select class="mb-3" v-model="edittgtitem.type"
              :options="['default','事件Event','物品','房屋','房间',{label: '容器/位置/桌子/柜子/其它容器',options: ['容器','位置','桌子','柜子','其它容器'] },'文本/idea/snippet']">
            </b-form-select>
          </span>
          <div v-if="edittgtitem.type=='物品'" class="mb-3"><br>
            <h5>数量（仅物品有这一特征，必填）：</h5>
            <b-form-input v-model="edittgtitem.数量" type="number" placeholder="1"></b-form-input>
          </div>
          <div v-if="edittgtitem.type=='事件Event'" class="mb-5 mt-1"><br>
            <h5>事件信息——截止日期（必填）：</h5>
            <b-row>
              <b-col cols="6">
                <b-form-datepicker v-model="edittgtitem.截止日期阳历" locale="zh" placeholder="选择日期" selected-variant="danger"
                  nav-button-variant="warning" @input="edittgtitem.截止日期=edittgtitem.截止日期阳历;etUseLunar=isCurrentLunar()">
                </b-form-datepicker>
              </b-col>
              <b-col cols="6">
                <b-form-timepicker v-model="edittgtitem.截止时间" locale="zh" placeholder="选择时间"
                  @context="edittgtitem.截止时间=edittgtitem.截止时间.slice(0,5)"></b-form-timepicker>
              </b-col>
            </b-row>
            <b-row class="mb-3">
              <b-col cols="6">
                <b-form-input v-model="edittgtitem.截止日期" locale="zh" placeholder="选择日期"
                  @change="(e)=>{if(e.startsWith('农历')){try{sp=e.slice(2).split('-');edittgtitem.截止日期阳历=moment().year(sp[0]).month(sp[1]-1).date(sp[2]).solar().format('YYYY-MM-DD');}catch(f){}}else{edittgtitem.截止日期阳历=e}}">
                </b-form-input>
              </b-col>
              <b-col cols="6">
                <b-form-input v-model="edittgtitem.截止时间" locale="zh" placeholder="选择时间"
                  @input="(e)=>{console.log(e);tmpstr=e; str1=''; if([...tmpstr.matchAll(/[0-9]/g)].length>4){tmpstr=tmpstr.split('').pop()};
                for ( let i of tmpstr.matchAll(/[0-9]/g)){str1 += i[0]}; edittgtitem.截止时间=str1.slice(0,2).padStart(2,'-')+':'+str1.slice(2,4).padStart(2,'-');}"></b-form-input>
              </b-col>
            </b-row>
            <b-form-checkbox class="ml-3" size="lg" style="display: inline-block;" v-model="etUseLunar"
              @input="ToggleLunar">使用中国农历日期</b-form-checkbox>
            <b-row class="mb-3">
              <b-col cols="6">
                <h5 style="text-align:right;">重复间隔（0为不重复）：</h5>
              </b-col>
              <b-col cols="3">
                <b-form-input v-model="edittgtitem.重复数" type="number"></b-form-input>
              </b-col>
              <b-col cols="3">
                <b-form-select v-model="edittgtitem.重复间隔" :options="['日','周','月','季度','年','小时']"></b-form-select>
              </b-col>
            </b-row>
            <div class="mb-3">
              <b-row class="mb-1" v-for="noti in edittgtitem.notifications">
                <b-col cols="6">
                  <h5 style="text-align:right;">在还有多长时间前通知：</h5>
                </b-col>
                <b-col cols="3">
                  <b-form-input v-model="noti[0]" type="number"></b-form-input>
                </b-col>
                <b-col cols="3">
                  <b-form-select v-model="noti[1]" :options="['发生时','日','周','月','季度','年','小时']"></b-form-select>
                </b-col>
              </b-row>
              <b-row class="mb-1">
                <b-col cols="6"></b-col>
                <b-col cols="6">
                  <b-button class="nopad" variant="warning" @click="edittgtitem.notifications.push(['3','小时'])">↑增加一次通知
                  </b-button>
                  <b-button class="nopad" variant="danger" @dblclick="edittgtitem.notifications.pop()"
                    @click="if(ctrl_is_down){edittgtitem.notifications.pop()}">↑双击删除最后一条通知</b-button>
                </b-col>
              </b-row>
            </div>
            <span style="font-size: 20px;font-weight: bold;">完成状态：</span>
            <b-form-checkbox size="lg" v-model="edittgtitem.已完成" name="checkbox-1" value="已完成" unchecked-value="未完成"
              style="display: inline;">{{edittgtitem.已完成}}</b-form-checkbox>
          </div>
          <h5>描述（or 一段话/备注）：
            <span v-if="edittgtitem.rtf==undefined">
              <b-button class="nopad" style="font-weight: bold;" variant="warning"
                @click="Vue.set(edittgtitem,'rtf','')">&emsp;启用富文本RTF内容&emsp;</b-button>
            </span><span v-if="edittgtitem.rtf!=undefined">
              <b-button class="nopad" style="font-weight: bold;" variant="warning" @click="editRTF">
                &emsp;编辑富文本RTF内容&emsp;</b-button>
              <b-button class="nopad" style="font-weight: bold;" variant="outline-danger"
                @click="if(window.confirm('确定删除RTF？不可撤销')){Vue.delete(edittgtitem,'rtf')}">删除RTF</b-button>
            </span> |
            <span v-if="edittgtitem.program==undefined">
              <b-button class="nopad" style="font-weight: bold;" variant="danger"
                @click="Vue.set(edittgtitem,'program',['clip',`with open('file.path', 'r', encoding='utf-8') as f: str = f.read(); f.close()`,'','Language-Python'])">
                &emsp;启用小程序/代码&emsp;</b-button>
            </span><span v-if="edittgtitem.program!=undefined">
              <b-button class="nopad" style="font-weight: bold;" variant="danger" @click="editProgram">
                &emsp;编辑小程序/代码&emsp;</b-button>
              <b-button class="nopad" style="font-weight: bold;" variant="outline-danger"
                @click="if(window.confirm('确定删除小程序/代码？不可撤销')){Vue.delete(edittgtitem,'program')}">删除小程序</b-button>
            </span>
          </h5>
          <b-form-textarea v-model="edittgtitem.描述" size="sm" placeholder="描述/备注（可以是一段话）" rows="8"></b-form-textarea>
          <!-- <b-form-input v-model="edittgtitem.描述" type="text" placeholder="输入描述（可以是一句话）"></b-form-input> -->
          <br>
          <h5>词向量描述：</h5>
          <div id="edittgtitem词向量描述">
            <div v-for="descitem in edittgtitem.词向量描述">
              <b-form-input v-model="descitem" type="text" placeholder="输入词向量描述~"></b-form-input>
            </div>
          </div>
          <b-button class="nopad" variant="warning" @click="edittgtitem.词向量描述.push('')">↑增加词向量条目</b-button>
          <b-button class="nopad" variant="danger" @click="edittgtitem.词向量描述.pop()">↑删除最后一条词向量条目</b-button>
          <br><br>
          <h5>句向量描述：</h5>
          <div id="edittgtitem句向量描述">
            <div v-for="descitem in edittgtitem.句向量描述">
              <b-form-textarea v-model="descitem" size="sm" placeholder="输入句向量描述~" rows="1"></b-form-textarea>
            </div>
          </div>
          <b-button class="nopad" variant="warning" @click="edittgtitem.句向量描述.push('')">↑增加句向量条目</b-button>
          <b-button class="nopad" variant="danger" @click="edittgtitem.句向量描述.pop()">↑删除最后一条句向量条目</b-button>
          <b-dropdown id="dropdown-form-sentence" text="批量插入句向量" ref="dropdown" style="height: 24px;line-height: 24px;"
            variant="outline-info">
            <b-dropdown-form>
              <b-form-textarea v-model="batchSentences" rows="8" size="sm" style="width: 500px;"
                placeholder="请输入一些句子，不必换行，自动检测。"></b-form-textarea>
              <b-button variant="primary" size="sm" @click="addBatchSentences">确认添加</b-button>
            </b-dropdown-form>
          </b-dropdown>
          <br><br>
          <h5>文件：</h5>
          <div id="edittgtitemfiles">
            <div v-for="fileinfo, i in edittgtitem.files" style="margin-top: 9px;"><span
                style="font-weight: bold;font-family:'Sarasa Term SC', 'Menlo', serif;color: #137af7;">文件 {{i}}
                信息：</span>
              <b-form-radio-group button-variant="outline-info" v-model="fileinfo[3]"
                :options="[{ text: '附件(点击后下载)', value: 'attachment' },{ text: '点击后浏览器打开', value: 'preview' },{ text: '缩略图', value: 'thumbnail', disabled: fileinfo[3]!='thumbnail' }]"
                buttons></b-form-radio-group>
              <span style="float: right;">
                <b-button class="nopad" variant="danger" @click="tgtitemDeleteFile(i)"> &nbsp;←删除&nbsp; </b-button>
                <b-button class="nopad" variant="outline-warning" @click="generateThumbnail(fileinfo)">
                  &nbsp;生成缩略图&nbsp; </b-button>
                <b-button class="nopad" variant="primary" v-if="i!=0"
                  @click="edittgtitem.files[i]=edittgtitem.files.splice(i-1,1,edittgtitem.files[i])[0]"> &nbsp;↑上浮&nbsp;
                </b-button>
                <b-button class="nopad" variant="success" v-if="i!=(edittgtitem.files.length-1)"
                  @click="edittgtitem.files[i]=edittgtitem.files.splice(i+1,1,edittgtitem.files[i])[0]"> &nbsp;↓下移&nbsp;
                </b-button>
              </span>
              <br>
              <b-form-input class="filefname" v-model="fileinfo[0]" type="text" placeholder="输入fname，文件名称~">
              </b-form-input>
              <b-form-textarea class="filefdescr" v-model="fileinfo[1]" size="sm" placeholder="描述/备注（可以是一段话）" rows="1">
              </b-form-textarea>
            </div>
          </div>
          <b-button class="nopad" variant="warning" @click="initEditFileInfo">↑增加文件</b-button>
        </div>
      </b-overlay>
    </b-modal>
    <!-- ↓文件上传页面modal。 -->
    <b-modal id="editFileInfo" title="文件上传" no-close-on-backdrop hide-footer @hide="cancelEditFileInfoIfUploaded">

      <div class="d-block">
        <b-overlay :show="busy_connecting_backend" rounded="sm">
          <h5>选择文件(或直接ctrl+v粘贴)：</h5>
          <h4>【请注意，涉密文件、隐私文件、涉及公司利益文件等千万不要上传！！！】</h4>
          <form role="form" class="form" onsubmit="return false;" enctype="multipart/form-data">
            <div class="form-group">
              <input id="uploadFilePortal" type="file" />
            </div>
            <button id="uploadSubmit" type="button" class="btn btn-primary" @click="uploadFile(false)">Upload!</button>
          </form>
        </b-overlay>
        <b-progress v-if='uploadPercentCompleted<1' id="FileUploadProgressBar" :value="uploadPercentCompleted" :max="1"
          show-progress animated></b-progress>
        <b-progress v-if='uploadPercentCompleted==1' id="FileUploadProgressBar" :value="uploadPercentCompleted" :max="1"
          variant='success'></b-progress>
        <br><span v-if="fileUploaded">
          <h5>文件信息：</h5>
          输入fname，文件名称：<br>
          <b-form-input v-model="edittgtfile[0]" type="text" placeholder="输入fname，文件名称~"></b-form-input>
          输入fdescr，文件描述：<br>
          <b-form-textarea v-model="edittgtfile[1]" size="sm" placeholder="输入fdescr，文件描述~" rows="8"></b-form-textarea>
          请选择该文件的类别属性：
          <b-form-radio-group button-variant="outline-warning" v-model="edittgtfile[3]"
            :options="[{ text: '附件(点击后下载)', value: 'attachment' },{ text: '点击后浏览器打开', value: 'preview' },{ text: '缩略图', value: 'thumbnail', disabled: true }]"
            buttons></b-form-radio-group>
          <b-button variant="warning" @click="saveEditFileInfo" class="mt-2">✅ 确认添加至仓库</b-button>
        </span>
      </div>

    </b-modal>
    <!-- 预览缩略图modal -->
    <b-modal id="previewImgModal" title="缩略图预览" size='lg'>
      <center><img id="prevImg" v-bind:src="previewImgURL"
          style="max-width:calc(100% - 10px);max-height:calc(100% - 10px);object-fit: contain;"></img></center>
    </b-modal>
    <!-- RTF modal ，关于 ignore-enforce-focus-selector see 文档。-->
    <b-modal id="RTFModal"
      ignore-enforce-focus-selector=".ke-input-text, .ke-textarea, .ke-code-type, select, input, textarea"
      title="富文本编辑器 RTFModal (关闭modal即保存)" size='xl' @shown="editRTFShown" @hide="saveRTF">
      <editor id="editor_id" height="500px" width="700px" pluginsPath="/editor/plugins/"></editor>
    </b-modal>
    <b-modal id="ConfirmModal" hide-footer hide-header no-close-on-esc ignore-enforce-focus-selector="textarea"
      @show="ConfirmResult='default'"
      @hide="if(ConfirmResult=='default'){ConfirmResult==true};app.ConfirmPromiseResolve('foo');">{{ConfirmText}}<br>
      <b-button variant="danger" @click="ConfirmResult=false;app.$bvModal.hide('ConfirmModal');">
        &emsp;&emsp;取消&emsp;&emsp;</b-button>
      <b-button variant="success" @click="ConfirmResult=true;app.$bvModal.hide('ConfirmModal');">
        &emsp;&emsp;确认&emsp;&emsp;</b-button>
    </b-modal>
    <!-- Program modal -->
    <b-modal id="ProgramModal" title="小程序[图灵完备VueApp]/任意代码高亮 ProgramModal" size='xl' @shown="editProgramShown"
      @hide="saveProgram">
      <h5>选择类型：</h5>
      <b-form-radio-group button-variant="outline-danger" v-model="tmpProgType"
        :options="[{text:'任意代码片段',value:'clip'},{ text:'简单模板',value:'template'},{text:'B-Vue App',value:'bvapp'},{text:'Any Web App',value:'htmljs'},{text:'Yield Prolog',value:'prolog'}]"
        buttons @change="changeProgType"></b-form-radio-group>
      <span v-if="tmpProgType=='clip'">
        <b-dropdown id="dropdown-form" v-bind:text="tmpProgLang.slice(9)" ref="dropdown" class="m-2">
          <b-dropdown-form style="width: 330px;">

            <b-form-group label="手动输入语种" label-for="dropdown-form-lang">
              <b-form-input id="dropdown-form-lang" placeholder="" v-model="tmpProgLangUserInput"></b-form-input>
            </b-form-group>
            <b-button variant="primary" @click="tmpProgLang='Language-'+tmpProgLangUserInput">Apply</b-button>
          </b-dropdown-form>
          <b-dropdown-divider></b-dropdown-divider>
          <b-dropdown-item-button @click="tmpProgText=tmpProgTextRealtime;tmpProgLang='Language-Python'">Python
          </b-dropdown-item-button>
          <b-dropdown-item-button @click="tmpProgText=tmpProgTextRealtime;tmpProgLang='Language-HTML'">HTML
          </b-dropdown-item-button>
          <b-dropdown-item-button @click="tmpProgText=tmpProgTextRealtime;tmpProgLang='Language-Mathematica'">
            Mathematica</b-dropdown-item-button>
          <b-dropdown-item-button @click="tmpProgText=tmpProgTextRealtime;tmpProgLang='Language-xls'">Excel Formulae
          </b-dropdown-item-button>
          <b-dropdown-item-button @click="tmpProgText=tmpProgTextRealtime;tmpProgLang='Language-prolog'">Prolog
          </b-dropdown-item-button>
          <b-dropdown-item-button @click="tmpProgText=tmpProgTextRealtime;tmpProgLang='Language-bash'">bash
          </b-dropdown-item-button>
          <b-dropdown-item-button @click="tmpProgText=tmpProgTextRealtime;tmpProgLang='Language-AppleScript'">
            AppleScript</b-dropdown-item-button>
          <b-dropdown-item-button @click="tmpProgText=tmpProgTextRealtime;tmpProgLang='Language-VBA'">VBA
          </b-dropdown-item-button>
          <b-dropdown-item-button @click="tmpProgText=tmpProgTextRealtime;tmpProgLang='Language-javascript'">javascript
          </b-dropdown-item-button>
          <b-dropdown-item-button @click="tmpProgText=tmpProgTextRealtime;tmpProgLang='Language-css'">css
          </b-dropdown-item-button>
        </b-dropdown>
      </span>
      <div v-if="tmpProgType=='clip'">
        <pre v-highlightjs="tmpProgText">
          <code spellcheck="false" contenteditable="true" v-bind:class="tmpProgLang" id="P1_ProgramClipCode" @input="app.tmpProgTextRealtime=getProgText('#P1_ProgramClipCode')"></code>
        </pre>
        <b-button class="nopad" variant="warning" @click="app.tmpProgText=app.tmpProgTextRealtime">↑高亮代码</b-button>
      </div>

      <div v-if="tmpProgType=='template'">
        <b-row>
          <b-col>
            <type><br>HTML:</type>
            <pre v-highlightjs="tmpProgText">
              <code spellcheck="false" contenteditable="true" class="Language-html" id="P2_html" @input="app.tmpProgTextRealtime=getProgText('#P2_html');app.renderProg()"></code>
            </pre>
            <type>js:</type>
            <pre v-highlightjs="tmpProgText2">
              <code spellcheck="false" contenteditable="true" class="Language-javascript" id="P2_js" @input="app.tmpProgText2Realtime=getProgText('#P2_js');app.renderProg()"></code>
            </pre>
          </b-col>
          <b-col>
            <type><br>呈现的页面:</type>
            <iframe id='ProgIframeView' style='width:100%; border: none;'></iframe>
          </b-col>
        </b-row>
        <b-button class="nopad" variant="warning"
          @click="app.tmpProgText=app.tmpProgTextRealtime;app.tmpProgText2=app.tmpProgText2Realtime">↑高亮代码</b-button>
      </div>

      <div v-if="tmpProgType=='bvapp'">
        <b-row>
          <b-col>
            <type><br>HTML:</type>
            <pre v-highlightjs="tmpProgText">
              <code spellcheck="false" contenteditable="true" class="Language-html" id="P3_html" @input="app.tmpProgTextRealtime=getProgText('#P3_html');app.renderProg()"></code>
            </pre>
            <type>js:</type>
            <pre v-highlightjs="tmpProgText2">
              <code spellcheck="false" contenteditable="true" class="Language-javascript" id="P3_js" @input="app.tmpProgText2Realtime=getProgText('#P3_js');app.renderProg()"></code>
            </pre>
          </b-col>
          <b-col>
            <type><br>呈现的页面:</type>
            <iframe id='ProgIframeView' style='width:100%; border: none;'></iframe>
          </b-col>
        </b-row>
        <b-button class="nopad" variant="warning"
          @click="app.tmpProgText=app.tmpProgTextRealtime;app.tmpProgText2=app.tmpProgText2Realtime">↑高亮代码</b-button>
      </div>

      <div v-if="tmpProgType=='htmljs'">
        <b-row>
          <b-col>
            <type><br>HTML:</type>
            <pre v-highlightjs="tmpProgText">
              <code spellcheck="false" contenteditable="true" class="Language-html" id="P4_ProgramCode" @input="app.tmpProgTextRealtime=getProgText('#P4_ProgramCode');app.renderProg()"></code>
            </pre>
          </b-col>
          <b-col>
            <type><br>呈现的页面:</type>
            <iframe id='ProgIframeView' style='width:100%; border: none;'></iframe>
          </b-col>
        </b-row>
        <b-button class="nopad" variant="warning" @click="app.tmpProgText=app.tmpProgTextRealtime">↑高亮代码</b-button>
      </div>

      <div v-if="tmpProgType=='prolog'">
        <form name="queryForm">
          <div class="mt-3">Query:</div>
          <textarea spellcheck="false" style="width: 100%;border-top: 3px solid #f71372;border-radius: 5px;" rows="15"
            name="prolog" type="text"></textarea><br>
          <b-button class="mt-3" name="compile" @click="submitQuery()" variant="warning">🏃‍♀️🎽🏃‍♂️Run！</b-button>
          /*若输入分析失败，可设置js全局变量 output_parse_verbose=true 来检查何处为爆栈断点。*/<br>
          <div class="mt-3">Output:</div>
          <textarea spellcheck="false" style="width: 100%;" rows="9" name="output" type="text"></textarea>
        </form>
        Samples: <a href="javascript:void(0)" onclick="document.queryForm.prolog.value = ''">Clear 清除输入.</a> | <a
          href="javascript:void(0)" onclick="document.queryForm.prolog.value = 'write(\'Hello world!\'), nl.'">Hello
          world</a> | <a href="javascript:void(0)" onclick="document.queryForm.prolog.value = 'X is 2 + 2.'">2+2</a> |
        <a href="javascript:void(0)" onclick="document.queryForm.prolog.value ='assert(parent(\'Chelsea\', \'Hillary\')).\n\
        assert(parent(\'Chelsea\', \'Bill\')).\n\n\
        assert(brother(\'Hillary\', \'Tony\')).\n\
        assert(brother(\'Hillary\', \'Hugh\')).\n\
        assert(brother(\'Bill\', \'Roger\')).\n\n\
        assert((uncle(Person, Uncle) :-\n\
        parent(Person, Parent), \n\
        brother(Parent, Uncle))).'">assert uncle</a> | <a href="javascript:void(0)"
          onclick="document.queryForm.prolog.value = 'uncle(Person, Uncle).'">query
          uncle</a> | <a href="javascript:void(0)"
          onclick="document.queryForm.prolog.value = 'setof(Uncle, Parent^(parent(Person, Parent), brother(Parent, Uncle)), Uncles).'">
          all Uncles (using setof)</a> | <a href="javascript:void(0)"
          onclick="document.queryForm.prolog.value ='abolish(parent/2).\nabolish(brother/2).\nabolish(uncle/2).'">
          abolish uncle</a> | <a href="javascript:void(0)"
          onclick="document.queryForm.prolog.value = 'read(&quot;\n\
        % This string is converted to a list of char codes, parsed, and bound to Goal.\nwrite(\'Hello world!\'),\nnl.\n&quot;, Goal), Goal.'">
          parse and call</a> | <a href="javascript:void(0)"
          onclick="document.queryForm.prolog.value = '% ↓定义函数。先在后台注册函数：\nassert((test覆盖(Message, Title, 位置) :- true)).\n% 然后覆盖\n\/\*js:\*\nYP._predicatesStore[\'test覆盖/3\']._clauses[0]._function=function*(msg, t, pos) {\napp.$bvToast.toast(\'\'+msg,{variant:\'warning\', title:\'\'+t, toaster:pos!=1?\'b-toaster-bottom-right\':\'b-toaster-top-full\'});  console.log(msg, \'said!\')\nfor (let l1 of YP.unify(msg, Atom.a(\'Bill\'))) {\n  for (let l2 of YP.unify(t, Atom.a(\'Bill2\'))) {\n    for (let l3 of YP.unify(pos, Atom.a(\'Bill3\'))) {\n      yield false;  console.log(msg, msg._name, \'Matched!\')\n  }}}\n}**\/\n% 测试覆盖成功：\ntest覆盖(\'hi~\', \'TITLE\', TmpVar).   test覆盖(\'喵喵喵喵喵！\', \'汪汪汪儿\', 1).\ntest覆盖(\'Bill\', \'Bill2\', A).'">
          自定义js函数覆盖</a> | <a href="javascript:void(0)"
          onclick="document.queryForm.prolog.value = '\/\*js:* \/\/本段代码不会实际注册函数，且语法与assert((……:-…….))有差别，仅供参考。\ntmpstr = getCompiledCode(\'\\\nvalid([Head|Tail]):-  \\\n fd_all_different(Head),   \\\n valid(Tail) . \')\ndocument.queryForm.output.value=tmpstr\n**/'">
          查看prolog→js编译结果</a><br> | Full-featured Prolog environment in YieldProlog.js, complete with a Prolog parser
        and compiler. 注意！这只是一个runtime界面，无保存功能。要保存prolog程序，请用描述文本保存。<br>
        % 标记prolog整行注释。&emsp; &emsp; /* 这是prolog注释。 */ &emsp; &emsp;
        /*js:* console.log("用/*js*……**/包裹的部分将被认定为js代码，被自动eval后可结合Yield-Prolog语法采用内置函数定义谓词。") **/<br>
      </div>
    </b-modal>
    <!-- copyPasteModal -->
    <b-modal id="copyPasteModal" ignore-enforce-focus-selector="textarea" hide-footer title="复制粘贴管理">
      <b-button variant="danger" @click="genCopyLink">&emsp;&emsp;复制本项目&emsp;&emsp;</b-button>复制链接
      <br>↓粘贴链接
      <b-form-input v-model="copyPaste1"></b-form-input>
      <b-button variant="success" @click="submitPasteLink">&emsp;&emsp;粘贴至本层&emsp;&emsp;</b-button>
    </b-modal>
    <!-- showTgtInfoModal -->
    <b-modal id="showTgtInfoModal" ignore-enforce-focus-selector="textarea" hide-footer title="元素&其子树属性">
      <b-button variant="danger" @click="TgtFullCopy">&emsp;&emsp;复制本项目子树中全部代码and描述&emsp;&emsp;</b-button>
      prolog以及其他程序专用，可复制子树知识库。将只复制程序代码片段or描述（若有代码片段则复制代码片段，否则复制描述），不复制标题，以双回车键分隔。支持在描述开头写入“
      %PROGRAM-IMPORT:{"模组1","模组2"}:END
      ”以引入依赖项（替换相应代码至import处）。依赖项需在当前仓库中，名称按标题识别。依赖项将只引入一次，以免重复定义；且依赖项代码保证出现在描述后文内容的前面（除非出现循环引用）。<br><br>
      <span style="white-space: pre-wrap;">{{editorText}}</span>
    </b-modal>
  </div>

  </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>


  <script src="https://cdn.jsdelivr.net/npm/axios@0.21.1/dist/axios.min.js"
    integrity="sha256-JLmknTdUZeZZ267LP9qB+/DT7tvxOOKctSKeUC2KT6E=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js"
    integrity="sha256-kXTEJcRFN330VirZFl6gj9+UM6gIKW195fYZeR3xDhc=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap-vue@2.21.2/dist/bootstrap-vue.min.js"
    integrity="sha256-duDNIhfVrUK7HB/57nPLxN/j92aM3rhTUFzVI/H5ex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap-vue@2.21.2/dist/bootstrap-vue-icons.min.js"
    integrity="sha256-+7aTGlsPhtUfXQj29DQVQS38pYiduzLU2DRdLntmwBI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jssha@2.3.1/src/sha256.js"
    integrity="sha256-NyuvLfsvfCfE+ceV6/W19H+qVp3M8c9FzAgj72CW39w=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
  <script src="https://unpkg.com/moment-lunar@0.0.4/moment-lunar.min.js"></script>
  <script type="text/javascript">
    daysMap = new Map()
    editor = null; // RTF编辑器
    isLoading = false; cancelUploadFunc = undefined; app = { entershoulddefault: false };
    前缀str = `<html lang='zh'>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
  integrity="sha256-93wNFzm2GO3EoByj9rKZCwGjAJAwr0nujPaOgwUt8ZQ=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-vue@2.21.2/dist/bootstrap-vue.min.css"
  integrity="sha256-cAyk5KZc7P6j7j/uL7MOoN4PRsZYp+BN9yo03Y6Qk38=" crossorigin="anonymous">
<style>*{font-family:'Sarasa Term SC'}body{white-space:pre-wrap}</style>
</head>
<body><div id="app"><!-- vue instance -->`;

    中缀str = `<!-- vue instance end --></div></body>
<sc`+ `ript src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js"
  integrity="sha256-kXTEJcRFN330VirZFl6gj9+UM6gIKW195fYZeR3xDhc=" crossorigin="anonymous"></sc`+ `ript>
<sc`+ `ript src="https://cdn.jsdelivr.net/npm/bootstrap-vue@2.21.2/dist/bootstrap-vue.min.js"
  integrity="sha256-duDNIhfVrUK7HB/57nPLxN/j92aM3rhTUFzVI/H5ex8=" crossorigin="anonymous"></sc`+ `ript>
<sc`+ `ript>`;

    后缀str = `</sc` + `ript>
</html>`;

    上次刷新的时间 = new Date('1995-12-17T03:24:00');
    本次input的时间 = new Date('1995-12-17T03:24:00');
    scroll刷新时间 = new Date(); ItemScrollUpdatedYPos = 0;

    var getProgText = function (selector) {
      var el = document.querySelector(selector);
      var childs = el.childNodes;
      for (var i = childs.length - 1; i >= 0; i--) {
        if (childs[i].tagName == "BR") { el.removeChild(childs[i]); }
      }
      return el.innerText
    };
    var cumulativeOffset = function (element) {
      var top = 0, left = 0;
      do {
        top += element.offsetTop || 0;
        left += element.offsetLeft || 0;
        element = element.offsetParent;
      } while (element);
      return {
        top: top,
        left: left
      };
    };
    function err503() { app.$bvToast.toast(`Server 503 Error`, { autoHideDelay: 2500, variant: "danger", toaster: 'b-toaster-bottom-right' }); }
    function escapeHTMLgenLink(unsafe) {
      return unsafe.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;").replace(/(&lt;a href=&quot;)?((((https?:\/\/(www\.)?)|(www\.))[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z0-9]{1,6}\b(([-a-zA-Z0-9@:%_\+.~#?//=]|&amp;)*)))(&quot;&gt;(.*)&lt;\/a&gt;)?/gi, function () {
        return '<a target="_blank" href="' + arguments[2] + '">' + (arguments[11] || arguments[2]) + '</a>'
      });
    }
    function ItemScrollTop(e) { console.log(e); window.scrollTo(0, cumulativeOffset(e.parentElement.parentElement.parentElement).top - 300) }
    function ItemScrollDown(e) { window.scrollTo(0, cumulativeOffset(e.parentElement.parentElement.parentElement).top + e.parentElement.parentElement.parentElement.getBoundingClientRect().height - window.innerHeight + 200) }
    output_parse_verbose = false
    function getCompiledCode(prologCode) {
      YP.see(new YP.StringReader(prologCode + ' ')); var output = new YP.StringWriter(); YP.tell(output)
      var TermList = new Variable(); var PseudoCode = new Variable()
      for (let l1 of parseInput(TermList)) {
        for (let l2 of makeFunctionPseudoCode(TermList, PseudoCode))
          convertFunctionJavascript(PseudoCode);
      }
      YP.seen(); YP.told(); return output.toString()
    }
    function submitQuery() {

      if (document.queryForm.prolog.value == "") {
        alert("Please enter Prolog code or click one of the Samples")
        return
      }
      var context_str = document.queryForm.prolog.value
      var evalQ = []
      context_str = context_str.replace(/\/\*js:\*(.*?)\*\*\//gs, (match, p1) => { evalQ.push(p1); return '|-SpLiT^jScODe*|' })

      var seqQ = context_str.split('|-SpLiT^jScODe*|')
      var allOutput = ''
      for (let i = 0; i < evalQ.length + 1; i++) {
        var outputWriter = new YP.StringWriter()
        YP.tell(outputWriter)
        var Goal = new Variable()
        var VariableList = new Variable()
        for (let l1 of parseGoal(seqQ[i], Goal, VariableList)) {
          try {
            var gotMatch = false
            for (let l2 of YP.getIterator(Goal, null)) {
              gotMatch = true
              if (YP.getValue(VariableList) != Atom.NIL) {
                writeValues(outputWriter, VariableList)
                outputWriter.writeLine(";")
              }
            } if (gotMatch) { if (YP.getValue(VariableList) == Atom.NIL) outputWriter.writeLine("true (matched without value).") }
            else
              outputWriter.writeLine("fail")
          } catch (exception) {
            if (exception instanceof PrologException) {
              outputWriter.writeLine(exception._term.toString())
              app.$bvToast.toast("\n ******↑上述错误发生于：\n" + seqQ[i] + "\n ******end.", { title: "prolog Error:" + exception._term.toString(), variant: "danger", noAutoHide: true, toaster: 'b-toaster-bottom-right' })
            }
            else
              throw exception
          }
        }
        YP.told()
        allOutput = allOutput + outputWriter.toString()
        document.queryForm.output.value = ''
        if (i < evalQ.length) { eval(evalQ[i]) }
        allOutput = allOutput + '\n' + document.queryForm.output.value
      }

      document.queryForm.output.value = allOutput
    }
    function* parseGoal(goalString, Goal, VariableList) {
      YP.see(new YP.StringReader(goalString + " "));
      var TermList = new Variable();
      for (let l1 of parseInput(TermList)) {
        YP.seen()
        for (TermList = YP.getValue(TermList);
          TermList instanceof Functor2 && TermList._name == Atom.DOT;
          TermList = YP.getValue(TermList._arg2)) {
          for (let l2 of YP.unify
            (TermList._arg1, new Functor2(Atom.F, Goal, VariableList)))
            yield false
        }
        return
      } YP.seen()
    }
    function writeValues(outputWriter, VariableList) {
      for (VariableList = YP.getValue(VariableList);
        VariableList instanceof Functor2 && VariableList._name == Atom.DOT;
        VariableList = YP.getValue(VariableList._arg2)) {
        var variableAndValue = YP.getValue(VariableList._arg1)
        if (variableAndValue instanceof Functor2) {
          outputWriter.writeLine("")
          outputWriter.write(YP.getValue(variableAndValue._arg1).toString())
          outputWriter.write(" = ")
          outputWriter.write(YP.getValue(variableAndValue._arg2).toString())
        }
      }
    }
    function copyStringToClipboard(str) {
      try { // Remove temporary element
        document.body.removeChild(textarea_copy_el);
      } catch (error) { console.error(error); }
      // Create new element
      textarea_copy_el = document.createElement('textarea');
      // Set value (string to be copied)
      textarea_copy_el.value = str;
      // Set non-editable to avoid focus and move outside of view
      textarea_copy_el.setAttribute('readonly', '');
      textarea_copy_el.style.position = "absolute"
      textarea_copy_el.style.left = "-9999px"
      document.body.appendChild(textarea_copy_el);
      // Select text inside element
      textarea_copy_el.select();
      // Copy text to clipboard
      document.execCommand('copy');
    }
    var app = new Vue({
      el: '#app',
      data: {
        isLoggedIn: {[{ is_Logged_In }]}, weekDayMap: ["周日", "周一", "周二", "周三", "周四", "周五", "周六"], allowTypeSelection: true, finishedTimeAsc: false,
        fullitems: [],
        warehouses: [""],
        search_result: [],
        busy_connecting_backend: false,
        isQueryingBackend: false,
        entershoulddefault: false,
        ConfirmText: '', ConfirmResult: null, ConfirmPromiseResolve: null,
        page_history: 1,
        query_txt: '',
        resnumber: 888, fullTxtPressed: [true, true, true],
        edittgtitem: { type: "default", 名称: "垃圾堆", 描述: "垃圾堆", 数量: 1, 内容: [] },
        edittgtfile: ['', '', '', 'attachment'], fileUploaded: false, uploadPercentCompleted: 0,
        focused_elem_stack: [],
        show_search_result_mode: false,
        currentDraggedElem: null,
        currentDragTarget: null,
        consoleCmd: "",
        backupList: [], newBackupName: "",
        showSidebar: false, showBackupSidebar: false,
        previewImgURL: "",
        loadedJsLibs: { hljs: false, kindeditor: false }, tmpProgType: "clip", tmpProgText: "", tmpProgTextRealtime: "", tmpProgText2: "", tmpProgText2Realtime: "",
        tmpProgLang: "Language-python", tmpProgLangUserInput: "go",
        editorText: '',
        batchSentences: '', copyPaste1: '', SRCurrentPage: 1, SRPerPage: 20, etUseLunar: false,
        chvUpSvg: `<svg viewBox="0 0 16 16" width="1em" height="1em" focusable="false" role="img" aria-label="chevron double up" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi-chevron-double-up b-icon bi"><g><path fill-rule="evenodd" d="M7.646 2.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 3.707 2.354 9.354a.5.5 0 1 1-.708-.708l6-6z"></path><path fill-rule="evenodd" d="M7.646 6.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 7.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"></path></g></svg>`,
        chvDownSvg: `<svg viewBox="0 0 16 16" width="1em" height="1em" focusable="false" role="img" aria-label="chevron double down" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi-chevron-double-down b-icon bi"><g><path fill-rule="evenodd" d="M1.646 6.646a.5.5 0 0 1 .708 0L8 12.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"></path><path fill-rule="evenodd" d="M1.646 2.646a.5.5 0 0 1 .708 0L8 8.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"></path></g></svg>`
      },
      mounted() {
        window.history.pushState({ page: 1 }, "", "");
        if (this.CurWarehouse.slice(0, 11) == '初始化URLBase-') { this.CurWarehouse = this.CurWarehouse.slice(11); this.getitems([]); } //如果有URL预设，那就要这一家仓库的。
        else { this.CurWarehouse = '当前focus数据结构'; this.getitems([]); }
        setTimeout(() => {
          app.scrollLoadPics()
          window.addEventListener('scroll', app.scrollLoadPics)
        }, 888);
        this.getwarehouses();
      },
      methods: {
        scrollLoadPics: function () {
          当前时间 = new Date();
          if (当前时间 - scroll刷新时间 < 88) { return }
          scroll刷新时间 = new Date();
          picsList = document.querySelectorAll('.thumbimage')
          picsList.forEach(element => {
            const elOffsetTop = cumulativeOffset(element).top;
            const docScrollTop = -document.documentElement.getBoundingClientRect().top;
            // console.log(elOffsetTop, docScrollTop)
            if (!element.attributes.src && elOffsetTop >= docScrollTop && elOffsetTop < (docScrollTop + window.innerHeight)) {
              // console.log(element.attributes.srclazy.value)
              element.setAttribute("src", element.attributes.srclazy.value);
            }
          });
          function NavUpdateScroll(Yc, F) {
            setTimeout(() => {
              if (Yc == window.scrollY && Yc != ItemScrollUpdatedYPos) {
                ItemScrollUpdatedYPos = Yc;
                NavsList = document.querySelectorAll('.ItemScrollNav')
                NavsList.forEach(e => {
                  var winH = window.innerHeight
                  var ep = e.getBoundingClientRect()
                  var cp = e.parentElement.parentElement.getBoundingClientRect()
                  if ((winH - ep.height) / 2 < cp.top) { e.style.top = 0 }
                  else if ((winH + ep.height) / 2 > cp.bottom) { e.style.top = -cp.top + cp.bottom - ep.height }
                  else { e.style.top = -cp.top + (winH - ep.height) / 2 }
                })
              } else { F(window.scrollY, () => { }) }
            }, 233)
          }
          NavUpdateScroll(window.scrollY, NavUpdateScroll)
        },
        dragstartF: function (e, item) { },
        dragenterF: function (e, item) { },
        dragleaveF: function (e, item) { },
        dragenterFLast: function (e, parentitem) { },
        dragleaveFLast: function (e, parentitem) { },
        dropF: function (e, item) { },
        bdisplhover: function (event) {
          event.stopPropagation();
          tmpstack = []; curelem = event.target;
          while (curelem.parentElement.parentElement.classList.contains("bdispl")) {
            curelem = curelem.parentElement.parentElement;
            tmpstack.push(curelem)
          }
          tmpstack.reverse();
          if (this.focused_elem_stack.length > tmpstack.length) { return }
          try {
            this.focused_elem_stack.forEach(element => {
              element.className = element.className.replace(' TheFocusedItem', '')
            });
          } catch (error) { }
          this.focused_elem_stack = tmpstack;
          // ↑重算focus_elem_stack。
          this.focused_elem_stack.forEach(element => {
            element.className = element.className.replace(' TheFocusedItem', '')
          });
          this.focused_elem_stack.push(event.target);
          event.target.className = event.target.className + ' TheFocusedItem';
          return;
        },
        bdisplleave: function (event) {
          var element = this.focused_elem_stack.pop();
          if (element) {
            element.className = element.className.replace(' TheFocusedItem', '')
          }
          var tmpe = this.focused_elem_stack.pop();
          if (tmpe) {
            this.focused_elem_stack.push(tmpe);
            tmpe.className = tmpe.className + ' TheFocusedItem';
          }
          event.stopPropagation();
          return;
        },
        toggleExpand: function (item) { item.expandDesc = !(item.expandDesc) },
        login: function () {
          if (this.signup_username.length < 2) { window.alert("用户名长度不得小于2位，请重新输入！"); return; }
          if (this.signup_password.length < 5) { window.alert("密码长度不得小于5位，请重新输入！"); return; }
          console.log("log in.");
          var hashObj = new jsSHA("SHA-256", "TEXT", { numRounds: 1 });
          hashObj.update(this.signup_username + this.signup_password + "salter2333");
          var hash = hashObj.getHash("HEX");
          console.log('generated login auth:', hash, 'connecting to backend...');
          this.busy_connecting_backend = true;
          axios.post('/storageManager/log-in', {
            username: this.signup_username,
            auth: hash,
          }).then(function (response) {
            // console.log(response);
            // console.log(response.data);
            login_state = response.data;
            app.busy_connecting_backend = false;
            if (login_state != 'ok') {
              if (login_state == 'already_logged_in') { window.alert("当前用户已经登录。出现此提示应为前端错误，请您刷新网页。"); return; }
              if (login_state == 'nosignup') { window.alert("当前用户尚未注册。请您先注册哟~"); return; }
              window.alert("登录失败，应是用户名或密码错误。请检查输入~\n未注册需先注册。"); return;
            }
            app.$bvModal.hide('bv-modal-login');
            app.isLoggedIn = true;
            window.alert("登录成功！");
          }).catch(function (error) {
            console.log(error);
          })
        },
        logout: function () {
          console.log("log out.");
          axios.post('/storageManager/log-out', {}).then(function (response) {
            app.isLoggedIn = false;
            window.alert("退出登录成功！");
          }).catch(function (error) {
            console.log(error);
          })
        },
        getitems: function (level) {
          axios.post('/storageManager/get-items-ViewOnly', {
            level: level, warehs: this.CurWarehouse,
            baseInd: this.baseInd, authentication: this.authentication, userName: this.userName, viewUrlPath: this.viewUrlPath
          }).then(function (response) {
            resptext = response.data;
            if (level.length == 0) { app.fullitems = eval(resptext); if (app.isTimeManagement) { app.TimeSortAsc(); } return }
            target = app.fullitems;
            for (const i of level.slice(0, -1)) {
              target = target[i].内容
            }
            target[level[level.length - 1]].内容 = eval(resptext);
            console.log(target);
            app.$forceUpdate();
          }).catch(function (error) {
            console.log(error); window.alert("您可能未登录哟~或获取后端信息出错，为了保证数据结构不受损害，请刷新页面！！")
          })
        },
        prepareBackupSidebar: function () { this.showBackupSidebar = true; app.backupList = ["当前处于查看模式。无法查看用户backup列表信息"] },
        restoreBackup: function (backup) { },
        removeBackup: function (backup) { },
        createNewBackup: function () { },
        clearTemp: function () { },
        getwarehouses: function (level) { app.warehouses = ["当前处于查看模式。无法查看用户warehouse列表信息"] },
        executeCmdCommand: function () {
          tgtind = this.warehouses.indexOf(this.consoleCmd);
          if (tgtind == -1) { window.alert("定位库失败，请确认库名称是否正确！"); return; }
          this.warehouseFocus(tgtind)
        },
        rmWarehouse: function (ind) { },
        warehouseFocus: function (ind) { },
        addWarehouse: function () { },
        renameWarehouse: function (ind) { },
        moveUpWarehouse: function (ind) { },
        moveDownWarehouse: function (ind) { },
        recursivelyGetItems: function (level) {
          this.$bvToast.toast(`请注意不要急于操作。本次导航预计耗时：` + (0.6 + level.length * 0.2) + "秒。", {
            title: '⚠️正在导航，请注意不要急于操作！',
            autoHideDelay: 4000,
            appendToast: true,
            variant: "danger",
            toaster: 'b-toaster-bottom-right'
          })
          for (let i = 0; i < level.length; i++) { setTimeout(() => { app.getitems(level.slice(0, i + 1)) }, i * 200) }
          setTimeout(() => {
            if (level.length == 0) { return }
            target = app.fullitems;
            for (const i of level.slice(0, -1)) {
              target = target[i].内容
            }
            console.log(target)
            target[level[level.length - 1]].isfocus = true;
            app.show_search_result_mode = false;
            app.$forceUpdate();
            setTimeout(() => {
              window.scrollTo(0, cumulativeOffset(document.getElementById("resultScrollMark")).top - 160);
              app.$forceUpdate();
              setTimeout(() => {
                delete target[level[level.length - 1]].isfocus;
                app.$forceUpdate();
              }, 1500);
            }, 200);
          }, 400 + level.length * 200);
          return (0.6 + level.length * 0.2);
        },
        deleteitems: function (level) { },
        additems: function (level) { },
        edittarget: function (level) {
          console.log("edittarget", level)
          if (level.length == 0) { this.edittgtitem = this.fullitems; return }
          target = app.fullitems;
          for (const i of level.slice(0, -1)) {
            target = target[i].内容
          }
          this.edittgtitem = target[level[level.length - 1]];
          var it = this.edittgtitem;
          var x = new Date();
          currentTimeZoneOffsetInHours = - x.getTimezoneOffset() / 60;
          var day = new Date(); day.setHours(day.getHours() + currentTimeZoneOffsetInHours); var str = day.toISOString();
          this.allowTypeSelection = true;
          if (this.isTimeManagement) { if (level.length <= 1) { Vue.set(it, "type", "事件Event"); this.allowTypeSelection = false } }
          if (!it.截止日期) { Vue.set(it, "截止日期", str.slice(0, 10)) };
          if (!it.截止日期阳历) { Vue.set(it, "截止日期阳历", str.slice(0, 10)) };
          if (!it.截止时间) { Vue.set(it, "截止时间", '17:00') };
          if (!it.重复数) { Vue.set(it, "重复数", 0) };
          if (!it.重复间隔) { Vue.set(it, "重复间隔", '日') };
          if (!it.notifications) { Vue.set(it, "notifications", [['0', '发生时']]) };
          if (!it.已完成) { Vue.set(it, "已完成", '未完成') };
          if (!it.数量) { Vue.set(it, "数量", 1) };
          this.etUseLunar = this.isCurrentLunar()
          this.$bvModal.show('edittargetmodal')
        },
        saveedittgt: function () { },
        tgtitemDeleteFile: function (i) { },
        initEditFileInfo: function () { },
        uploadFile: function (file2) { },
        cancelEditFileInfoIfUploaded: function () { },
        saveEditFileInfo: function () { },
        getfile: function (path) {
          window.open(encodeURI('/storageManager/get-file-ViewOnly?userName=' + app.userName + '&viewUrlPath=' + app.viewUrlPath.replace(/&/g, '**and**') + '&baseInd=' + app.baseInd + '&authentication=' + app.authentication + '&dlname=' + path[0] + '&path=' + path[2]))
        },
        generateThumbnail: function (path) { },
        previewImg: function (path) {
          this.$bvModal.show('previewImgModal');
          this.previewImgURL = encodeURI("/storageManager/get-file-ViewOnly?userName=" + app.userName + "&viewUrlPath=" + app.viewUrlPath.replace(/&/g, '**and**') + "&baseInd=" + app.baseInd + "&authentication=" + app.authentication + "&dlname=" + path[0] + '&path=' + path[2])
        },
        changeDir: function (path) { },
        copyItemLink: function (param) { },
        addBatchSentences: function () { },
        copyPasteMgmt: function () { },
        showTgtInfo: function () {
          axios.post('/storageManager/collectTgtInfo-ViewOnly', { ind: this.edittgtitem.ind, wh: this.CurWarehouse, baseInd: this.baseInd, authentication: this.authentication, userName: this.userName, viewUrlPath: this.viewUrlPath }
          ).then(function (response) {
            app.editorText = response.data;
            app.$bvModal.show('showTgtInfoModal');
          })
        },
        TgtFullCopy: function () {
          axios.post('/storageManager/copyFullTgtInfo-ViewOnly', { ind: this.edittgtitem.ind, wh: this.CurWarehouse, baseInd: this.baseInd, authentication: this.authentication, userName: this.userName, viewUrlPath: this.viewUrlPath }
          ).then(function (response) {
            copyStringToClipboard(response.data)
            app.$bvToast.toast('已将子树内容复制至剪贴板~', { autoHideDelay: 2500, variant: "success", toaster: 'b-toaster-bottom-right' })
          })
        },
        genCopyLink: function () { },
        submitPasteLink: function () { },
        editProgram: function () {
          const LoadScriptPromise = new Promise((resolve, reject) => {

            if (!app.loadedJsLibs.hljs) {
              var newScript = document.createElement('link');
              newScript.rel = 'stylesheet';
              // newScript.href = "https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.3.1/build/styles/default.min.css";
              newScript.href = "/static/仓储管理/style.css";
              document.getElementsByTagName('head')[0].appendChild(newScript);
              // 脚本加载完毕
              newScript.onload = function () {

                var newScript = document.createElement('script');
                newScript.type = 'text/javascript';
                newScript.src = '/static/仓储管理/highlight.min.js';
                document.getElementsByTagName('head')[0].appendChild(newScript);
                var newScript = document.createElement('script');
                newScript.type = 'text/javascript';
                newScript.src = '/static/仓储管理/YieldProlog.min.js';
                document.getElementsByTagName('head')[0].appendChild(newScript);

                newScript.onload = function () {
                  var newScript = document.createElement('script');
                  newScript.type = 'text/javascript';
                  newScript.src = '/static/仓储管理/mathematica.min.js';
                  document.getElementsByTagName('head')[0].appendChild(newScript);
                  newScript = document.createElement('script');
                  newScript.type = 'text/javascript';
                  newScript.src = '/static/仓储管理/applescript.min.js';
                  document.getElementsByTagName('head')[0].appendChild(newScript);
                  newScript = document.createElement('script');
                  newScript.type = 'text/javascript';
                  newScript.src = '/static/仓储管理/vba.min.js';
                  document.getElementsByTagName('head')[0].appendChild(newScript);
                  // 脚本加载完毕
                  app.loadedJsLibs.hljs = true;
                  newScript.onload = function () {

                    // 引入vue plugin
                    Vue.directive('highlightjs', {
                      deep: true,
                      bind: function (el, binding) {
                        // on first bind, highlight all targets
                        let targets = el.querySelectorAll('code')
                        targets.forEach((target) => {
                          // if a value is directly assigned to the directive, use this
                          // instead of the element content.
                          if (binding.value) {
                            target.textContent = binding.value
                          }
                          hljs.highlightBlock(target)
                        })
                      },
                      componentUpdated: function (el, binding) {
                        // after an update, re-fill the content and then highlight
                        let targets = el.querySelectorAll('code')
                        targets.forEach((target) => {
                          if (binding.value) {
                            target.textContent = binding.value
                            hljs.highlightBlock(target)
                          }
                        })
                      }
                    })

                    resolve('foo');
                  }

                }

              }
            } else { resolve('foo'); }

          });
          // 第一次编辑时需要load script(Highlight.js)。
          LoadScriptPromise.then(() => {

            app.tmpProgType = app.edittgtitem.program[0];
            app.tmpProgText = app.edittgtitem.program[1];
            app.tmpProgText2 = app.edittgtitem.program[2];
            app.tmpProgLang = app.edittgtitem.program[3];
            app.$bvModal.show('ProgramModal');
          })
        },
        editProgramShown: function () {
          hljs.highlightAll();
          app.tmpProgTextRealtime = app.tmpProgText;
          app.tmpProgText2Realtime = app.tmpProgText2;
          app.renderProg();
        },
        changeProgType: function (e) { app.tmpProgType = app.edittgtitem.program[0]; return; },
        renderProg: function () {
          本次input的时间 = new Date();
          setTimeout(function () {
            当前时间 = new Date();
            if ((当前时间 - 上次刷新的时间 > 499) && (当前时间 - 本次input的时间 > 499)) { // 这是最后一次输入。
              var html, encodedHtml, tV = app.tmpProgType
              if (tV == 'template') {
                html = 前缀str + app.tmpProgTextRealtime.replace(/\\{/g, '{{ "\\{" }}').replace(/\\}/g, '{{ "\\}" }}') + 中缀str + app.tmpProgText2Realtime.replace(/\\{/g, '{{ "\\{" }}').replace(/\\}/g, '{{ "\\}" }}') + 后缀str;
                encodedHtml = encodeURIComponent(html);
              }
              if (tV == 'bvapp') {
                html = 前缀str + app.tmpProgTextRealtime + 中缀str + app.tmpProgText2Realtime + 后缀str;
                encodedHtml = encodeURIComponent(html);
              }
              if (tV == 'htmljs') { encodedHtml = encodeURIComponent(app.tmpProgTextRealtime) }
              if (tV != 'clip' && tV != 'prolog') {
                var viewEl = document.getElementById('ProgIframeView');
                viewEl.style.height = '700px';
                viewEl.src = 'data:text/html,' + encodedHtml;
                上次刷新的时间 = new Date();
              }
            }
          }, 500);
        },
        saveProgram: function (e) { setTimeout(() => { app.$bvModal.hide('ProgramModal'); }, 200); },
        editRTF: function () {
          const LoadScriptPromise = new Promise((resolve, reject) => {

            if (!app.loadedJsLibs.kindeditor) {
              var newScript = document.createElement('link');
              newScript.rel = 'stylesheet';
              newScript.href = "/editor/themes/default/default.css";
              document.getElementsByTagName('head')[0].appendChild(newScript);
              // 脚本加载完毕
              newScript.onload = function () {

                var newScript = document.createElement('script');
                newScript.type = 'text/javascript';
                newScript.src = '/editor/kindeditor-all-min.js';
                document.getElementsByTagName('head')[0].appendChild(newScript);
                // 脚本加载完毕
                app.loadedJsLibs.kindeditor = true;
                newScript.onload = function () {

                  var newScript = document.createElement('script');
                  newScript.type = 'text/javascript';
                  newScript.src = '/editor/lang/zh-CN.js';
                  document.getElementsByTagName('head')[0].appendChild(newScript);
                  // 脚本加载完毕
                  app.loadedJsLibs.kindeditor = true;
                  newScript.onload = function () {
                    resolve('foo');
                  }

                }

              }
            } else { resolve('foo'); }

          });
          // 第一次编辑时需要load script(KindEditor)。
          LoadScriptPromise.then(() => { app.$bvModal.show('RTFModal'); })
        },
        editRTFShown: function () {
          // KindEditor.ready(function(K) {
          //   window.editor = K.create('#editor_id');
          // });
          KindEditor.options.filterMode = false;
          editor = KindEditor.create('#editor_id');
          document.querySelector("#RTFModal___BV_modal_body_ > div").style.width = '100%';
          document.querySelector("#RTFModal___BV_modal_body_ > div > div.ke-edit").style.height = '800px';
          document.querySelector("#RTFModal___BV_modal_body_ > div > div.ke-edit > iframe").style.height = '800px';
          document.querySelector("#RTFModal___BV_modal_body_ > div > div.ke-edit > textarea").style.height = '798px';
          this.editorText = ''
          if (this.edittgtitem.rtf) { this.editorText = this.edittgtitem.rtf }
          editor.html(this.editorText)
        },
        saveRTF: function (e) { setTimeout(() => { app.$bvModal.hide('RTFModal'); app.saveedittgt(); }, 200); },
        simpleExample: function () {
          if (this.query_txt == "") {
            this.query_txt = "[<洗发露>]+[<飘柔>]*0.5+[<清爽>]*0.3"
          } else {
            if (window.confirm("您的搜索栏中有文字。继续操作将清空您之前输入的内容。真的要继续吗？")) {
              this.query_txt = "[<洗发露>]+[<飘柔>]*0.5+[<清爽>]*0.3"
            }
          }
        },
        rebuildNGT: function () { },
        rebuildNGTReloadVec: function () { },
        searchSubtree: function (tgt) {
          if (isLoading == false) {
            var plus = /＋/gm;
            var plus2 = /➕/gm;
            var minus = /－/gm;
            var minus2 = /➖/gm;
            var times = /×/gm;
            var times2 = /✖️/gm;
            var lq = / \(/gm;
            var rq = /\) /gm;
            var space = / /gm;
            this.query_txt = this.query_txt.replace(plus, "+").replace(plus2, "+").replace(minus, "-").replace(minus2, "-").replace(times, "*").replace(times2, "*").replace(lq, "(").replace(rq, ")").replace(space, "");
            if (this.query_txt.length > 300) { window.alert("QUERY TOO LONG!!"); return; }
            if (this.query_txt.length == 0) { window.alert("您尚未输入搜索字符串！"); return; }
            var qs = this.query_txt.split("#"); var translatedQ = ""; var sendmsg = '';
            qs.forEach(p => {
              if (p.startsWith('/') && p.endsWith('/')) { translatedQ += (p + '#'); p = p.slice(1, p.length - 1); sendmsg += (p + '#') }
              else if (p.startsWith('【') && p.endsWith('】')) { translatedQ += (p + '#'); sendmsg += (p + '#') }
              else { // translate
                p = p.replace(/(\[\<(.+?)(?=\>\])\>\])|(([^\+\-\*\/＋－×➕✖️➖0-9\.\(\)\>]+))/gm, function () { return '[<' + (arguments[2] || arguments[4]) + '>]' });
                translatedQ += (p + '#'); sendmsg += (p + '#')
              }
            });
            this.query_txt = translatedQ.slice(0, translatedQ.length - 1);

            isLoading = true;
            this.isQueryingBackend = true;
            setTimeout(() => { isLoading = false; }, 2000);
            axios.post('/storageManager/query-subtree-ViewOnly', {
              query: sendmsg.slice(0, sendmsg.length - 1),
              tgt: tgt,
              resnumber: this.resnumber,
              warehs: this.CurWarehouse, baseInd: this.baseInd, fullTxtMode: (this.fullTxtPressed[0] ? 'f' : '') + (this.fullTxtPressed[1] ? 'd' : '') + (this.fullTxtPressed[2] ? 'n' : ''),
              authentication: this.authentication, userName: this.userName, viewUrlPath: this.viewUrlPath
            }).then(function (response) {
              if (app.page_history < 2) { window.history.pushState({ page: app.page_history }, "", ""); }  // 浏览器返回
              app.page_history = Math.min(app.page_history + 1, 2);

              resptext = response.data;
              if (resptext == 'nope') { window.alert("您尚未登录哟~"); app.isQueryingBackend = false; return; }
              tmpobj = eval(resptext); founderr = false;
              tmpobj.forEach(element => {
                if (element == "notfound" && !founderr) { founderr = true; window.alert("后端搜索出错！已经帮助您重新搭建搜索NGT结构了~ 请您刷新页面，稍等再试！"); app.isQueryingBackend = false; app.rebuildNGT(); return; }
              });
              app.search_result = tmpobj;
              app.show_search_result_mode = true;
              app.isQueryingBackend = false;
              setTimeout(() => {
                window.scrollTo(0, 0);
              }, 270);
            }).catch(function (error) {
              console.log(error); app.isQueryingBackend = false;
            })
          } else {
            console.log("TOO MANY CLICKS!!")  // 防止多重点击！！
            window.alert("搜索过于频繁!!!仔细等结果2秒啊。")  // 防止多重点击！！
          }
        },
        GetTodayStr: function () {
          var x = new Date();
          currentTimeZoneOffsetInHours = - x.getTimezoneOffset() / 60;
          var day = new Date();
          day.setHours(day.getHours() + currentTimeZoneOffsetInHours);
          var str = day.toISOString().slice(0, 10);
          var arr = str.split('-').map(Math.abs);
          return arr[0] + '年' + arr[1] + '月' + arr[2] + '日' + ' ' + this.weekDayMap[day.getDay()] + ' ' + app.toLunarDesc(str)
        },
        GetDateDescription: function (item) {
          try {
            var x = new Date();
            currentTimeZoneOffsetInHours = - x.getTimezoneOffset() / 60;
            var day = new Date();
            day.setHours(day.getHours() + currentTimeZoneOffsetInHours);
            var str2 = day.toISOString();
            var pred = '';
            var splitted = item.截止日期阳历.split('-');
            if (splitted && splitted[0] != str2.slice(0, 4)) { pred = item.截止日期阳历.split('-')[0] + '年' }
            var dateDescs = ['大前天 ', '前天 ', '昨天 ', '今天 ', '明天 ', '后天 ', '大后天 ']
            day.setDate(day.getDate() - 3)
            for (let i = 0; i < dateDescs.length; i++) {
              var str = day.toISOString();
              if (item.截止日期阳历 == str.slice(0, 10)) { pred = dateDescs[i] + pred }
              day.setDate(day.getDate() + 1)
            }
            if (item.截止日期阳历 < str2.slice(0, 10)) { pred = '已过期 ' + pred }
            return pred + item.截止日期阳历.split('-').slice(1).map(Math.abs).join('月') + '日' + ' ' + this.weekDayMap[new Date(item.截止日期阳历).getDay()] + ' ' + app.toLunarDesc(item.截止日期阳历.slice(0, 10))
          } catch (error) {
            return '未知日期'
          }
        },
        timeMgmtClick: function (level) { },
        isCurrentLunar: function () { return this.edittgtitem.截止日期.startsWith("农历") },
        toLunarDesc: function (desc) { sp = desc.split('-'); return "农历" + moment().year(sp[0]).month(sp[1] - 1).date(sp[2]).lunar().format('YYYY-MM-DD') },
        ToggleLunar: function (checked) {
          dateStrV = this.edittgtitem.截止日期.match(/^(农历|)(.*)$/)[2]
          if (checked) {//转换至农历
            this.edittgtitem.截止日期 = '农历' + dateStrV
            sp = dateStrV.split('-')
            阳历str = moment().year(sp[0]).month(sp[1] - 1).date(sp[2]).lunar().format('YYYY-MM-DD');
            this.edittgtitem.截止日期阳历 = 阳历str
          } else {//转换至阳历
            this.edittgtitem.截止日期 = dateStrV
            this.edittgtitem.截止日期阳历 = dateStrV
          }
        },
        dateClass(ymd, date) {
          const day = date.getDate()
          if (daysMap.has(ymd)) {
            if (daysMap.get(ymd) == 1) { return 'table-success' }
            if (daysMap.get(ymd) == 2) { return 'table-primary' }
            if (daysMap.get(ymd) == 3) { return 'table-warning' }
            if (daysMap.get(ymd) > 3) { return 'table-danger' }
            return ''
          }
        },
        TimeSortAsc: function () {
          app.finishedTimeAsc = false;
          if (app.fullitems.length <= 1) { app.finishedTimeAsc = true; } app.$forceUpdate();
          //对todolist，自动调用move-item给底层排序。
          daysMap = new Map()// 用于决定dateClass给日历上色，统计事件数量
          var 原现ind记录 = []

          for (let i = 0; i < app.fullitems.length; i++) {
            var ddl = app.fullitems[i].截止日期阳历;
            if (daysMap.has(ddl)) { daysMap.set(ddl, daysMap.get(ddl) + 1) }
            else { daysMap.set(ddl, 1) }
            原现ind记录.push({ 后端初始ind: i, 截止日期阳历: ddl, 截止时间: app.fullitems[i].截止时间 })
          }
          var 原ind复制 = [...原现ind记录]
          原现ind记录.sort(function (e1, e2) {
            try {
              return new Date(e1.截止日期阳历 + ' ' + e1.截止时间) - new Date(e2.截止日期阳历 + ' ' + e2.截止时间);
            } catch (error) {
              return 0
            }
          });
          for (let i = 0; i < 原现ind记录.length; i++) {
            原现ind记录[i].后端目标ind = i
          }

          console.log("更新顺序")

          var action = (i) => {
            const myPromise = new Promise((resolve, reject) => {

              let 目前移动到的ind = i.i
              i.i = i.i + 1
              for (let i = 目前移动到的ind; i < 原ind复制.length; i++) {
                var element = 原ind复制[i];
                if (element.后端目标ind == 目前移动到的ind) { srci = i; tgti = element.后端目标ind; break }
              }
              // 若src在tgt后1位，则移动tgt元素，以节省可能的换序操作
              if (srci == tgti + 1) { srci = tgti; tgti = 原ind复制[tgti].后端目标ind; }
              // 因为是从tgt为0开始逐渐增加，因此 src 必>= tgt
              srcitem = 原ind复制.splice(srci, 1) // 删除srci
              原ind复制.splice(tgti, 0, srcitem[0]) // tgti处插入srcitem
              // 现在 原ind复制 里面表述的是后端的存放信息，下一步是要把 原ind复制 中需要挪动到下一个tgt的元素找到。
              // console.log(srci, tgti, srcitem)
              if (srci != tgti) {
                axios.post('/storageManager/move-items', { src: [srci], tgt: [tgti], warehs: app.CurWarehouse, baseInd: app.baseInd }).then(function (response) {
                  resptext = response.data; resvals = eval(resptext);
                  app.fullitems = resvals[0];
                  if (i.i == 原现ind记录.length - 1) { app.finishedTimeAsc = true }
                  app.$forceUpdate();
                  resolve(i);
                }).catch(function (error) {
                  console.log(error); window.alert("获取后端信息出错，为了保证数据结构不受损害，请刷新页面！！")
                })
              }
              else {
                if (i.i == 原现ind记录.length - 1) { app.finishedTimeAsc = true };
                resolve(i);
              }

            });
            return myPromise
          }

          const promiseFor = (i, n) => {
            var whilst = (i) => {
              return i.i < n ?
                action(i).then(whilst) :
                Promise.resolve(i);
            }
            return whilst(i);
          };
          i = { i: 0 }
          promiseFor(i, 原现ind记录.length).then(console.log("finish."))

        }
      }
    })

    document.addEventListener("keydown", function (event) {
      if (event.keyCode === 13 && ((!app.entershoulddefault) || event.shiftKey)) {
        event.preventDefault();
        app.searchSubtree([]);
      }
      if (event.keyCode === 112) {
        event.preventDefault();
        app.executeCmdCommand();
      }
      if (event.keyCode === 113) {
        app.consoleCmd = "";
        document.getElementById("cmdcommand").focus();
      }
      if (event.keyCode === 114) {
        document.getElementById("mainsearchbox").focus();
      }
    });
    document.onpaste = (evt) => {
      const dT = evt.clipboardData || window.clipboardData;
      const file = dT.files[0];
      if (file) { app.uploadFile(file) }
    };

    window.addEventListener("beforeunload", function (event) { if (reload_upload_focus_flip) { reload_upload_focus_flip = false; } });
    window.onpopstate = function (event) {
      console.log(event);
      if (app.page_history == 2) {
        app.page_history = 1;
        app.show_search_result_mode = false;
        app.$bvToast.toast(`本网站回退功能并不完善，如果多次搜索，会导致之前的搜索结果丢失，无法通过历史浏览记录复原。 因此请注意保存结果！          您上一次搜索的内容可以通过点击前进按钮恢复。`, {
          title: '⚠️请注意保存结果！',
          autoHideDelay: 10000,
          appendToast: true,
          variant: "danger",
          solid: true,
          toaster: 'b-toaster-bottom-right'
        })
      } else {
        app.page_history = 2; app.show_search_result_mode = true;
      }
    }
    window.onbeforeunload = function (e) { if (app.isEditing()) { e.returnValue = "您确认要离开当前界面吗？" } }
  </script>
</body>

</html>